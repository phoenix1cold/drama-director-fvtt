/* --- START OF FILE base-ui.css --- */

/* ==========================================================================
   base-ui.css
   - Core Layouts (Fixed 1920x1080 Resolution)
   - Overlay Containers
   - Configuration Windows
   ========================================================================== */

@import url('https://fonts.googleapis.com/css2?family=Teko:wght@600;700&display=swap');

/* ========================================= */
/* 1. CORE OVERLAY CONTAINERS (Safe)         */
/* ========================================= */

/* 
   1. 최상위 오버레이 
   - 위치 잡기용 (화면 전체)
   - 배경은 투명 (중앙 구멍으로 게임 화면을 봐야 함)
*/
#cinematic-overlay,
#cinematic-group-overlay {
    position: fixed;
    inset: 0;
    z-index: 10000;
    pointer-events: none;
    
    /* 평소엔 숨김 */
    display: none; 
    
    /* Flex로 중앙 정렬 */
    align-items: center;
    justify-content: center;
    
    background-color: transparent !important;
    overflow: hidden; /* 화면 밖 요소 숨김 */
}

/* 활성화 시 표시 */
#cinematic-overlay.active,
#cinematic-group-overlay.active {
    display: flex !important;
}

/* 투표 모드일 때는 클릭 허용 (버튼 눌러야 하니까) */
#cinematic-group-overlay.active.voting-mode {
    pointer-events: auto;
}

/* 
   2. [핵심] 가상 해상도 스테이지 (1920 x 1080 고정) 
   - 이 박스는 JS(_fitScreen)에 의해 사용자의 화면 크기에 맞춰 Scale(확대/축소).
   - 비율이 안 맞는 부분은 box-shadow가 채워줌 (레터박스).
*/
.cinematic-aspect-stage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform-origin: center center;
    translate: -50% -50%; /* 중앙 정렬 고정 */
    overflow: hidden;
}

/* --- [모드별 스타일] --- */

/* 1. 레터박스 계열 (16:9 유지 + 검은 여백) */
.cinematic-aspect-stage.mode-letterbox {
    box-shadow: 0 0 0 10000px #000 !important;
}
.cinematic-aspect-stage.mode-dimmed {
    box-shadow: 0 0 0 10000px rgba(0, 0, 0, 0.7) !important;
}

/* 2. 풀스크린/플로팅 계열 (여백 투명 또는 가득 채움) */
.cinematic-aspect-stage.mode-fit,
.cinematic-aspect-stage.mode-stretch,
.cinematic-aspect-stage.mode-cover {
    box-shadow: none !important;
    background-color: transparent !important;
}

/* 3. 오버레이 컨테이너 자체 배경 제거 (가장 중요) */
#cinematic-overlay, 
#cinematic-group-overlay {
    background-color: transparent !important;
}

/* 4. 플로팅 모드(fit)에서 경계선이 너무 칼같을 때를 위한 부드러운 효과 */
.cinematic-aspect-stage.mode-fit {
    filter: drop-shadow(0 0 20px rgba(0,0,0,0.5));
}

/* 
   3. 내부 래퍼 (실제 컨텐츠)
   - 스테이지(1920x1080)를 가득 채움
*/
#cinematic-overlay .cinematic-wrapper,
#cinematic-group-overlay .cinematic-group-container {
    position: absolute !important;
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    transform: none !important;
    margin: 0 !important;
}
/* ========================================= */
/* PREVIEW FIXES (설정창 미리보기)           */
/* ========================================= */

/* 1. 미리보기 컨테이너 (부모) - 투명 체크무늬 패턴 적용 */
.cinematic-config .preview-container,
.all-out-config .preview-stage-wrapper {
    flex: 1; 
    min-height: 0;
    width: 100%;
    
    position: relative;
    border: 2px solid #555;
    border-radius: 4px;
    overflow: hidden; 
    
    background-color: #1a1a1a;
    background-image:
      linear-gradient(45deg, #252525 25%, transparent 25%),
      linear-gradient(-45deg, #252525 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #252525 75%),
      linear-gradient(-45deg, transparent 75%, #252525 75%);
    background-size: 20px 20px;
    background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
}

/* 
   2. 미리보기 스테이지 (자식) 
   - 1920x1080 고정 해상도
   - 배경을 투명하게 설정하여 뒤의 체크무늬가 보이게 함
*/
.cinematic-config #preview-stage,
.all-out-config #group-preview-stage {
    position: absolute !important;
    width: 1920px !important;
    height: 1080px !important;
    
    /* 중앙 정렬 기준점 */
    top: 50% !important; 
    left: 50% !important;
    
    /* JS에서 scale이 적용될 때 translate(-50%, -50%)가 유지되도록 설정 */
    transform: translate(-50%, -50%); 
    transform-origin: center center;
    
    background-color: transparent !important; 
    box-shadow: none !important;
    border: 2px dashed #ffffff;
    filter: drop-shadow(0 0 1px #000); 
    pointer-events: none;
    box-sizing: border-box;
    display: block !important; /* hidden 상태를 무시하고 프리뷰에선 보이게 */
    background-color: transparent !important;
}

/* 
   3. 설정창 내부의 16:9 박스 강제 투명화 
   (혹시 모를 상속 문제 방지)
*/
.cinematic-config .cinematic-aspect-stage {
    background: transparent !important;
    box-shadow: none !important;
}
/* ========================================= */
/* COMMON ANIMATIONS & UTILS                 */
/* ========================================= */

.cinematic-wrapper.animate {
    animation: wrapper-fade-in-out var(--custom-duration, 4s) ease forwards;
}

.cinematic-aspect-stage.animate {
    animation: wrapper-fade-in-out var(--custom-duration, 4s) ease forwards;
}

.cinematic-aspect-stage.animate .cinematic-wrapper.animate {
    animation: none; 
}

@keyframes wrapper-fade-in-out {
    0% { opacity: 0; }
    5% { opacity: 1; }
    90% { opacity: 1; }
    100% { opacity: 0; }
}

.cinematic-character {
    position: absolute;
    z-index: 2;
    object-fit: contain;
    opacity: 0;
    pointer-events: none;
    width: auto;
    height: 100%;
    border: none;
}

.cinematic-pattern-overlay {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
    pointer-events: none;
}

.cinematic-custom-bg video,
.cinematic-custom-overlay video {
    pointer-events: none;
}

.cinematic-text-main {
    font-size: var(--main-font-size, 8rem);
    margin-left: var(--main-offset-x, 0px); margin-top: var(--main-offset-y, 0px);
    line-height: 0.9; color: #fff; text-transform: uppercase; font-weight: 700;
    opacity: 0; font-family: var(--cinematic-font, 'Teko'), sans-serif;
}

.cinematic-text-sub {
    font-size: var(--sub-font-size, 2rem);
    margin-left: var(--sub-offset-x, 0px); margin-top: calc(10px + var(--sub-offset-y, 0px));
    width: fit-content; font-weight: 600; letter-spacing: 5px;
    transform: scaleX(0); opacity: 0; font-family: var(--cinematic-font, 'Teko'), sans-serif;
}

/* 일시정지 (Pause) 유틸리티 */
.cinematic-wrapper.paused,
.cinematic-wrapper.paused *,
.cinematic-group-container.paused,
.cinematic-group-container.paused * {
    animation-play-state: paused !important;
}

/* ========================================= */
/* 2. CONFIG WINDOW STYLES (Scoped)          */
/* ========================================= */

.cinematic-config,
.all-out-config {
    min-width: 800px; 
    height: 600px;
    color: #efe6d8;
}

.cinematic-config .window-content,
.all-out-config .window-content {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden !important;
    padding: 0 !important;
}

.cinematic-config-wrapper {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    height: 100%;
    overflow: hidden;
    padding: 10px;
    box-sizing: border-box;
}

/* Left Panel */
.cinematic-config .config-panel,
.all-out-config .config-panel {
    overflow-y: auto;
    padding-right: 5px;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.cinematic-config .config-panel h3,
.all-out-config .config-panel h3 {
    border-bottom: 2px solid #333;
    padding-bottom: 5px;
    margin-top: 20px;
    margin-bottom: 10px;
    font-family: 'Teko', sans-serif;
    font-size: 1.5em;
    flex: 0 0 auto;
}
.cinematic-config .config-panel h3:first-child,
.all-out-config .config-panel h3:first-child { margin-top: 0; }

.cinematic-config .form-group,
.all-out-config .form-group {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
    width: 100%;
    min-height: 28px;
}

.cinematic-config .config-panel label,
.all-out-config .config-panel label { 
    flex: 0 0 100px;
    font-weight: bold; 
    font-size: 0.9em;
    white-space: nowrap;
    margin: 0;
}

.cinematic-config .form-fields,
.all-out-config .form-fields { 
    flex: 1;
    display: flex;
    align-items: center;
    gap: 5px;
    min-width: 0;
    width: 100%;
}

.cinematic-config .form-fields input,
.cinematic-config .form-fields select,
.cinematic-config .form-fields button,
.all-out-config .form-fields input,
.all-out-config .form-fields select,
.all-out-config .form-fields button {
    height: 28px;
    font-size: 0.9em;
    box-sizing: border-box;
    color: white;
    white-space: nowrap;
}

.cinematic-config .form-fields button,
.all-out-config .form-fields button {
    width: auto;
    flex-shrink: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0 8px;
}

.cinematic-config .preset-manager .form-group label { display: none; }
.cinematic-config .preset-manager .form-fields { width: 100%; }

.cinematic-config .form-fields.grid-layout {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 5px;
}

.cinematic-config .mini-field,
.all-out-config .mini-field,
.all-out-config-root .mini-field {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: rgba(0,0,0,0.1);
    padding: 2px;
    border-radius: 4px;
    justify-content: center;
}

.cinematic-config .mini-field label,
.all-out-config .mini-field label,
.all-out-config-root .mini-field label {
    flex: initial !important; 
    width: auto !important;
    height: auto !important;
    font-size: 0.75em;
    color: #888;
    margin-bottom: 2px;
    font-family: monospace;
    text-transform: uppercase;
    text-align: center;
    padding: 0 3px;
    min-width: 15px;
}

.cinematic-config .mini-field input,
.all-out-config .mini-field input,
.all-out-config-root .mini-field input {
    width: 100% !important;
    text-align: center;
    padding: 2px !important;
    height: 25px;
    font-size: 0.9em;
    border: none !important;
    background: transparent !important;
    color: #eee;
}

.cinematic-config .adjust-row {
    align-items: flex-start;
    margin-top: 10px;
}
.cinematic-config .adjust-row > label { margin-top: 5px; }

/* Preview Panel */
.cinematic-config .preview-panel {
    display: flex;
    flex-direction: column;
    background: #222;
    border-radius: 8px;
    padding: 15px;
    box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
    min-width: 0; 
    min-height: 0;
    height: 100%;
    overflow: hidden; 
    box-sizing: border-box;
}

.cinematic-config .preview-panel h3 {
    color: #fff;
    text-align: center;
    margin: 0 0 15px 0;
    font-family: 'Teko', sans-serif;
    flex: 0 0 auto;
}

.cinematic-config .preview-panel .hint {
    font-size: 0.8em;
    color: #888;
    text-align: center;
    margin-top: 10px;
    flex: 0 0 auto;
}

.cinematic-config .form-footer {
    margin-top: auto;
    display: flex;
    gap: 10px;
}

.cinematic-config .form-footer button {
    margin-top: 10px;
    padding: 10px;
    font-size: 1.2em;
    font-family: 'Teko', sans-serif;
    text-transform: uppercase;
    cursor: pointer;
    border: none;
    color: white;
    width: auto;
    height: auto;
}

.cinematic-config .form-footer button[data-action="reset"]:hover { background: #777 !important; }
.cinematic-config .form-footer button[data-action="save"]:hover { background: #ff2d49 !important; box-shadow: 0 0 15px #e61c34; }

/* Tabs Navigation (Common) */
.cinematic-tabs-nav {
    display: flex;
    background: #111;
    border-bottom: 2px solid #333;
    margin-bottom: 10px;
    border-radius: 4px 4px 0 0;
}

.cinematic-tabs-nav .item {
    flex: 1;
    padding: 10px;
    text-align: center;
    background: transparent;
    color: #888;
    cursor: pointer;
    font-family: 'Teko', sans-serif;
    font-size: 1.2em;
    transition: all 0.2s;
    border-bottom: 2px solid transparent;
}

.cinematic-tabs-nav .item:hover { color: #ccc; background: rgba(255,255,255,0.05); }
.cinematic-tabs-nav .item.active { color: #fff; background: #222; border-bottom: 2px solid #e61c34; font-weight: bold; }

.cinematic-config .tab-content, 
.cinematic-control .tab-content {
    display: none;
    animation: fade-in 0.2s ease-out;
}

.cinematic-config .tab-content.active, 
.cinematic-control .tab-content.active {
    display: block;
    background-color: rgb(11 10 19 / 90%);
}

@keyframes fade-in {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

/* ========================================= */
/* 3. ALL-OUT CONFIG LAYOUT (Scoped)         */
/* ========================================= */

.all-out-config-layout {
    display: grid;
    grid-template-columns: 400px 1fr;
    width: 100%; height: 100%;
    gap: 10px;
}

.all-out-config .config-sidebar {
    display: flex; flex-direction: column;
    overflow-y: auto; padding-right: 5px;
    background-color: rgb(11 10 19 / 90%);
    max-height: 100%;
}

.all-out-config .preview-sidebar {
    background: #111;
    border: 1px solid #444;
    border-radius: 4px;
    position: relative;
    overflow: hidden;
    display: flex; flex-direction: column;
    height: 100%;
}

.all-out-config .preview-stage-wrapper {
    flex: 1; position: relative; overflow: hidden; background: #000;
}

.all-out-config #group-preview-stage {
    position: absolute;
    top: 50%; left: 50%;
    width: 100%; 
    height: 100%;
    background: #222;
    transform: translate(-50%, -50%);
    transform-origin: center;
    pointer-events: none;
    box-shadow: 0 0 0 2px #555;
}

.all-out-config .execute-btn {
    width: 100%;
    background: #e61c34;
    color: #fff;
    border: none;
    padding: 15px;
    font-family: 'Teko';
    font-size: 1.5em;
    font-weight: bold;
    cursor: pointer;
}
.all-out-config .execute-btn:hover { background: #ff2d49; }
.all-out-config button[data-action="test"]:hover { background: #d35400 !important; }
.all-out-config button[data-action="play"]:hover { background: #ff2d49 !important; }

/* ========================================================= */
/* 4. CONTROL PANEL STYLES (Merged & Scoped)                 */
/* ========================================================= */

.cinematic-control-wrapper {
    height: 100%;
    display: flex;
    flex-direction: column;
    background: #1a1a1a;
    font-family: 'Teko', sans-serif;
    overflow: hidden;
    padding: 0;
}

/* Filter Buttons */
.cinematic-control-wrapper .filter-btn {
    flex: 1;
    background: #333;
    border: 1px solid #444;
    color: #888;
    cursor: pointer;
    padding: 5px;
    font-size: 0.9em;
    border-radius: 3px;
}
.cinematic-control-wrapper .filter-btn.active {
    background: #e61c34;
    color: #fff;
    border-color: #e61c34;
}
.cinematic-control-wrapper .filter-btn:hover:not(.active) {
    background: #444;
    color: #ccc;
}

/* Tabs Navigation */
.cinematic-control-wrapper .cinematic-tabs {
    display: flex;
    background: #111;
    border-bottom: 2px solid #333;
}

.cinematic-control-wrapper .tab-btn {
    flex: 1;
    background: transparent;
    border: none;
    color: #888;
    padding: 10px;
    font-family: 'Teko';
    font-size: 1.2em;
    cursor: pointer;
    transition: all 0.2s;
    border-bottom: 2px solid transparent;
}

.cinematic-control-wrapper .tab-btn:hover {
    color: #ccc;
    background: rgba(255, 255, 255, 0.05);
}

.cinematic-control-wrapper .tab-btn.active {
    color: #fff;
    background: #222;
    border-bottom: 2px solid #e61c34;
}

/* Tab Content Area */
.cinematic-control-wrapper .tab-content {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
}

/* Accordion Styles */
.cinematic-control-wrapper .accordion-item {
    margin-bottom: 5px;
    border: 1px solid #444;
    border-radius: 4px;
    background: #222;
    overflow: hidden;
}

.cinematic-control-wrapper .accordion-header {
    display: flex;
    align-items: center;
    padding: 8px 10px;
    background: #333;
    transition: background 0.2s;
}

.cinematic-control-wrapper .accordion-header:hover {
    background: #444;
}

.cinematic-control-wrapper .header-click-area {
    flex: 1;
    display: flex;
    align-items: center;
    cursor: pointer;
}

.cinematic-control-wrapper .actor-icon {
    margin-right: 10px;
    border: none;
}

.cinematic-control-wrapper .actor-name {
    flex: 1;
    font-size: 1.2em !important;
    font-weight: bold;
    color: #eee;
}

.cinematic-control-wrapper .actor-select-checkbox {
    margin-right: 10px;
    transform: scale(1.2);
    cursor: pointer;
}

/* Expanded State */
.cinematic-control-wrapper .accordion-item.expanded .accordion-header .arrow {
    transform: rotate(180deg);
}

.cinematic-control-wrapper .accordion-header .arrow {
    transition: transform 0.3s;
}

.cinematic-control-wrapper .accordion-content {
    display: none;
    padding: 5px;
    background: #252525;
    grid-template-columns: 1fr 1fr;
    gap: 5px;
}

.cinematic-control-wrapper .accordion-item.expanded .accordion-content {
    display: grid;
}

/* Buttons */
.cinematic-control-wrapper button {
    border: none !important;
    box-shadow: none !important;
    cursor: pointer;
    transition: all 0.2s;
    color: #888;
}

.cinematic-control-wrapper .config-btn {
    background: #444 !important;
    color: #aaa !important;
    grid-column: span 2;
    justify-content: center;
    border: none;
    padding: 8px;
    cursor: pointer;
    font-family: 'Teko';
    font-size: 1.1em;
    border-radius: 4px;
}

.cinematic-control-wrapper .config-btn:hover {
    background: #555 !important;
    color: #fff !important;
}

.cinematic-control-wrapper .preset-row {
    display: flex;
    gap: 5px;
    grid-column: span 2;
}

/* Full width rows */
.cinematic-control-wrapper .play-btn {
    flex: 1 !important;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    border: none;
    padding: 8px;
    border-radius: 4px;
    cursor: pointer;
    font-family: 'Teko';
    font-size: 1.1em;
    background: #e61c34 !important;
    color: white !important;
    height: 30px !important;
}

.cinematic-control-wrapper .play-btn:hover {
    background: #ff2d49 !important;
    box-shadow: 0 0 5px #e61c34;
}

.cinematic-control-wrapper .delete-btn {
    flex: 0 0 30px !important; width: 30px !important; height: 30px !important;
    padding: 0 !important; margin: 0 !important;
    display: flex !important; align-items: center !important; justify-content: center !important;
    background: #444 !important;
    color: #ff6b6b !important;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.cinematic-control-wrapper .delete-btn:hover {
    background: #662222 !important;
    color: #ff4444 !important;
}

/* Copy Button (Added from user snippet) */
.cinematic-control-wrapper .copy-btn {
    flex: 0 0 30px !important; width: 30px !important; height: 30px !important;
    padding: 0 !important; margin: 0 !important;
    display: flex !important; align-items: center !important; justify-content: center !important;
    background: #444 !important;
    color: #4ecdc4 !important;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.2s;
}

.cinematic-control-wrapper .copy-btn:hover {
    background: #226666 !important;
    color: #fff !important;
}

/* Group Preset Styles */
.cinematic-control-wrapper .all-out-btn.create-new {
    background: #333;
    border: 1px dashed #666;
    color: #aaa;
    padding: 15px;
    font-size: 1.5em;
    width: 100%;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'Teko';
    font-weight: bold;
}

.cinematic-control-wrapper .all-out-btn.create-new:hover {
    background: #444;
    color: #e61c34; /* Text color change on hover */
    border-color: #e61c34;
}

.cinematic-control-wrapper .group-preset-card {
    background: #252525;
    border: 1px solid #444;
    border-radius: 4px;
    padding: 10px;
    margin-bottom: 10px;
    border-left: 4px solid #e61c34;
}

.cinematic-control-wrapper .preset-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.cinematic-control-wrapper .preset-name {
    font-size: 1.3em;
    color: #fff;
    font-weight: bold;
}

.cinematic-control-wrapper .preset-actions {
    display: flex;
    gap: 5px;
}

.cinematic-control-wrapper .preset-actions button {
    background: #333;
    border: none;
    cursor: pointer;
    color: #888;
    padding: 0;
    width: 30px; height: 30px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 3px;
    transition: all 0.2s;
}

.cinematic-control-wrapper .btn-play:hover {
    background: #e61c34 !important;
    color: #fff !important;
}

.cinematic-control-wrapper .btn-edit:hover {
    background: #444 !important;
    color: #fff !important;
}

.cinematic-control-wrapper .btn-del:hover {
    background: #444 !important;
    color: #ff4444 !important;
}

.cinematic-control-wrapper .btn-copy {
    background: #444 !important; 
    color: #4ecdc4 !important;
}
.cinematic-control-wrapper .btn-copy:hover {
    background: #444 !important;
    color: #4ecdc4 !important;
}

.cinematic-control-wrapper .participant-previews {
    display: flex;
    gap: -8px;
    padding-left: 8px;
}

.cinematic-control-wrapper .mini-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: 2px solid #252525;
    object-fit: cover;
    margin-left: -8px;
    background: #333;
    transition: transform 0.2s;
}

.cinematic-control-wrapper .mini-avatar:hover {
    transform: translateY(-3px) scale(1.1);
    z-index: 10;
    border-color: #e61c34;
}

.cinematic-control-wrapper .no-data {
    text-align: center;
    color: #666;
    padding: 20px;
}

/* ========================================= */
/* 5. UTILITIES & FIXES (Scoped Inputs)      */
/* ========================================= */

.cinematic-canvas-shake {
    animation: cinematic-shake-anim 0.5s cubic-bezier(.36,.07,.19,.97) both;
    transform: translate3d(0, 0, 0);
    backface-visibility: hidden;
    perspective: 1000px;
}

@keyframes cinematic-shake-anim {
    10%, 90% { transform: translate3d(calc(-1px * var(--shake-power)), 0, 0); }
    20%, 80% { transform: translate3d(calc(2px * var(--shake-power)), 0, 0); }
    30%, 50%, 70% { transform: translate3d(calc(-4px * var(--shake-power)), 0, 0); }
    40%, 60% { transform: translate3d(calc(4px * var(--shake-power)), 0, 0); }
}

/* V12 Input Color Fixes - SCOPED TO MODULE CLASSES */
.cinematic-config input[type="text"],
.cinematic-config input[type="number"],
.cinematic-config select,
.all-out-config input[type="text"],
.all-out-config input[type="number"],
.all-out-config select {
    color: #ffffff !important; 
    background-color: #222 !important;
    border: 1px solid var(--color-border-light-primary, #555) !important;
    border-radius: 3px; 
}

.cinematic-config input::placeholder,
.all-out-config input::placeholder {
    color: rgba(255, 255, 255, 0.5) !important;
}

.cinematic-config input:focus,
.cinematic-config select:focus,
.all-out-config input:focus,
.all-out-config select:focus {
    box-shadow: 0 0 5px #e61c34;
    border-color: #e61c34 !important;
    color: #ffffff !important;
}

.cinematic-config select option,
.all-out-config select option,
.cinematic-config select optgroup,
.all-out-config select optgroup {
    background-color: #222 !important; 
    color: #ffffff !important;        
}

.cinematic-config button,
.all-out-config button {
    color: #ffffff;
}
.cinematic-config button:hover,
.all-out-config button:hover {
    color: #ffffff !important;
}

/* ========================================= */
/* SKIP BUTTON (Emergency Stop)              */
/* ========================================= */

#cinematic-skip-btn {
    position: fixed;
    bottom: 30px;
    right: 330px;
    z-index: 20000;
    pointer-events: auto;
    
    background: rgba(0, 0, 0, 0.6);
    color: #fff;
    border: 1px solid #777;
    border-radius: 20px;
    padding: 5px 12px;
    
    font-family: "Teko", sans-serif;
    font-size: 1.1rem;
    font-weight: 500;
    letter-spacing: 1px;
    cursor: pointer;
    
    transition: all 0.2s;
    opacity: 0;
    transform: translateY(10px);
    display: none; 
    
    backdrop-filter: blur(4px);
    align-items: center;
    gap: 6px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

#cinematic-skip-btn.visible {
    display: flex;
    opacity: 1;
    transform: translateY(0);
}

#cinematic-skip-btn:hover {
    background: #e61c34;
    border-color: #ff2d49;
    box-shadow: 0 0 10px #e61c34;
}

/* Custom Background & Overlay Support */
.cinematic-custom-bg {
    position: absolute; 
    inset: 0;
    width: 100%;
    height: 100%;
    display: flex;        
    align-items: center; 
    justify-content: center; 
    pointer-events: none;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    transform: translate(var(--custom-bg-x, 0px), var(--custom-bg-y, 0px)) scale(var(--custom-bg-scale, 1));
}

.animate .cinematic-custom-bg {
    opacity: var(--custom-bg-opacity, 0.5);
}

.cinematic-custom-overlay {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: 50; 
    pointer-events: none;
    background-image: var(--custom-overlay);
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    transform: translate(var(--custom-overlay-x, 0px), var(--custom-overlay-y, 0px)) scale(var(--custom-overlay-scale, 1));
    opacity: 1; 
}
.animate .cinematic-custom-overlay {
    opacity: 1;
}

/* Theme Hide Background Support */
.cinematic-wrapper.hide-bg .cinematic-bg-layer,
.cinematic-wrapper.hide-bg .cinematic-paint,
.cinematic-wrapper.hide-bg .cinematic-deco-line {
    display: none !important;
}

.cinematic-wrapper.hide-main-text .cinematic-text-main {
    display: none !important;
}

.cinematic-wrapper.hide-sub-text .cinematic-text-sub {
    display: none !important;
}

.cinematic-custom-bg .custom-media,
.cinematic-custom-overlay .custom-media {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    object-fit: contain; 
}

.cinematic-paint {
    width: 100%; 
    height: 100%;
    /* 배경색 띠는 끊기면 안 되므로 cover 혹은 넓은 배경색 유지 */
    background-size: cover;
}

.cinematic-custom-bg,
.cinematic-custom-overlay,
.char-mask {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
}


/* 인터랙티브 프롬프트 컨테이너 */
.cinematic-prompt-container {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 30000;
    width: 220px;
    height: 220px;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}

/* 바닥 점선 링 - 이제 정확히 중앙에서 돕니다 */
.prompt-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 190px;
    height: 190px;
    margin-top: -95px;
    margin-left: -95px;
    border: 3px dashed var(--theme-color);
    border-radius: 50%;
    animation: prompt-ring-spin 6s linear infinite;
    opacity: 0.6;
    pointer-events: none;
}

/* 메인 버튼 */
.prompt-button {
    position: relative;
    width: 130px;
    height: 130px;
    background: #111;
    border: 4px solid #fff;
    border-radius: 50%;
    cursor: pointer;
    overflow: hidden; /* 이미지를 동그랗게 자름 */
    box-shadow: 0 0 15px rgba(0,0,0,0.5), inset 0 0 20px var(--theme-color);
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: auto;
    z-index: 2;
}

.prompt-button:hover {
    transform: scale(1.1);
    box-shadow: 0 0 30px var(--theme-color);
    border-color: var(--theme-color);
}

.prompt-actor-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.9; /* 얼굴 잘 보이게 투명도 상향 */
    filter: contrast(1.1);
    transition: transform 0.3s;
}

.prompt-button:hover .prompt-actor-img {
    transform: scale(1.1);
}

/* READY? 라벨 - 더 작고 깔끔하게 */
.prompt-label {
    position: absolute;
    /* 1. 일단 정중앙으로 보냅니다 */
    top: 50%;
    left: 50%;
    
    /* 2. 중앙에서부터 버튼의 오른쪽 하단 방향으로 이동시킵니다.
       버튼 지름이 130px이므로, 중앙에서 약 45~55px 정도 밀어내면 버튼 테두리에 딱 붙습니다. */
    margin-top: 50px;   /* 양수일수록 아래로 */
    margin-left: 40px;  /* 양수일수록 오른쪽으로 */
    
    /* 3. 회전 각도 및 기본 기울기 */
    transform: translate(-50%, -50%) rotate(-8deg); 
    
    background: #fff;
    color: var(--theme-color);
    border: 2px solid var(--theme-color);
    
    font-family: 'Teko', sans-serif;
    font-size: 1.1rem;
    font-weight: 800;
    padding: 1px 12px;
    border-radius: 4px;
    
    box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.6);
    
    white-space: nowrap;
    z-index: 10;
    letter-spacing: 1px;
    pointer-events: none;
    
    /* 애니메이션 */
    animation: prompt-tag-settled 2.5s ease-in-out infinite;
}

@keyframes prompt-tag-settled {
    0%, 100% { transform: translate(-50%, -50%) rotate(-8deg); }
    50% { transform: translate(-50%, calc(-50% - 4px)) rotate(-8deg); } 
}

/* 지문 아이콘 - 작게 줄여서 구석으로 배치 */
.prompt-icon {
    position: absolute;
    right: 15px;
    top: 15px;
    font-size: 1.2rem; /* 훨씬 작게 */
    color: var(--theme-color);
    background: #fff;
    width: 25px;
    height: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
    opacity: 1;
    z-index: 3;
    animation: prompt-icon-pulse 1.5s infinite;
}

/* 취소 버튼 위치 조정 */
.prompt-gm-cancel {
    position: absolute;
    bottom: -50px;
    background: rgba(0,0,0,0.8);
    color: #aaa;
    padding: 5px 15px;
    border-radius: 20px;
    font-size: 0.8rem;
    cursor: pointer;
    border: 1px solid #444;
    pointer-events: auto;
    white-space: nowrap;
}

/* 애니메이션 정의 */
@keyframes prompt-ring-spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

@keyframes prompt-icon-pulse {
    0% { transform: scale(1); box-shadow: 0 0 0px var(--theme-color); }
    50% { transform: scale(1.2); box-shadow: 0 0 10px var(--theme-color); }
    100% { transform: scale(1); box-shadow: 0 0 0px var(--theme-color); }
}

.cinematic-prompt-container.fade-out {
    opacity: 0;
    transform: translate(-50%, -50%) scale(1.5);
    transition: all 0.3s ease-in;
}

/* 레이어 컨테이너들 */
.layers-back-container,
.layers-front-container {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: visible;
}

/* 순서 정의 (Stacking Context) */
.layers-back-container { z-index: 0; } /* 테마 배경(1)보다 뒤? 혹은 사이? 테마에 따라 다름 */
.cinematic-bg-layer    { z-index: 1; }
.cinematic-deco-line   { z-index: 2; }
.char-mask             { z-index: 5; } /* 캐릭터 */
.layers-front-container{ z-index: 8; } /* 캐릭터 위 */
.cinematic-content     { z-index: 10; } /* 텍스트 (맨 위) */

/* 만약 Back 레이어가 테마 배경(paint)보다 더 뒤에 가야 한다면 z-index: 0
   테마 배경과 캐릭터 사이에 넣고 싶다면 z-index: 1.5 등을 써야 함.
   하지만 단순화를 위해 Back=0으로 두고, 테마 요소들의 z-index를 1 이상으로 정리하는 게 좋음. */

.custom-layer-media {
    pointer-events: none;
    will-change: transform, opacity;
}/* --- START OF FILE theme-personal.css --- */

/* ==========================================================================
   theme-personal.css
   - Single Character Cut-in Themes
   - Animation Keyframes
   - Format Logic (Popout / Boxed)
   - Position Overrides
   ========================================================================== */

/* ==========================================================================
   1. THEME: BRUSH (Original) - 붓터치 느낌
   ========================================================================== */

/* 배경 모양 */
.cinematic-wrapper.theme-brush .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%) skewY(-5deg);
    filter: var(--border-filter, none);
}

.cinematic-wrapper.theme-brush .cinematic-paint {
    position: absolute;
    top: 0;
    left: -10%;
    width: 120%;
    height: 100%;
    background: var(--theme-color, #e61c34);
    background-image: radial-gradient(rgba(0, 0, 0, 0.2) 20%, transparent 20%);
    background-size: 10px 10px;
    clip-path: polygon(0% 20%, 45% 0%, 100% 15%, 100% 80%, 55% 100%, 0% 85%);
    transform: translateX(-120%);
    opacity: 0.9;
}

.cinematic-wrapper.theme-brush .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%) skewY(-5deg);
}

.cinematic-wrapper.theme-brush .cinematic-deco-line::after {
    content: "";
    position: absolute;
    top: 10%;
    left: 0;
    width: 120%;
    height: 5px;
    background: #fff;
    box-shadow: 0 0 10px #fff;
    transform: translateX(120%);
}

/* 텍스트 스타일 */
.cinematic-wrapper.theme-brush .cinematic-content {
    position: absolute;
    top: 50%;
    left: 10%;
    transform: translateY(-50%) skewY(-5deg);
    display: flex;
    flex-direction: column;
}

.cinematic-wrapper.theme-brush .cinematic-text-main {
    font-style: italic;
    -webkit-text-stroke: 2px #000;
    text-shadow: 5px 5px 0px var(--theme-color);
    color: var(--main-text-color, #fff);
}

.cinematic-wrapper.theme-brush .cinematic-text-sub {
    background: #fff;
    transform-origin: left;
    color: var(--sub-text-color, #000);
}

/* 등장 이펙트(deco-line)는 짧게 유지하고, 메인 요소들은 듀레이션을 따라가게 함 */
.cinematic-wrapper.theme-brush.animate .cinematic-paint {
    animation: brush-paint-seq var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-brush.animate .cinematic-deco-line::after {
    animation: brush-line-zip 0.6s ease-out forwards;
    animation-delay: 0.2s;
}

.cinematic-wrapper.theme-brush.animate .cinematic-text-main {
    animation: brush-text-seq var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-brush.animate .cinematic-text-sub {
    animation: brush-sub-seq var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.3s;
}


/* ==========================================================================
   2. THEME: CYBER (Sci-Fi) - 미래지향적
   ========================================================================== */

/* 배경 모양 */
.cinematic-wrapper.theme-cyber .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%);
    filter: var(--border-filter, none);
}

.cinematic-wrapper.theme-cyber .cinematic-paint {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--theme-color, #00d2ff);
    background-image: linear-gradient(rgba(0, 0, 0, 0.3) 50%, transparent 50%), linear-gradient(90deg, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
    background-size: 100% 4px, 20px 100%;
    clip-path: polygon(5% 0, 100% 0, 100% 80%, 95% 100%, 0 100%, 0 20%);
    transform: translateX(120%);
    opacity: 0.9;
}

.cinematic-wrapper.theme-cyber .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%);
}

.cinematic-wrapper.theme-cyber .cinematic-deco-line::after {
    content: "";
    position: absolute;
    top: 5px;
    left: 0;
    width: 120%;
    height: 2px;
    background: #fff;
    box-shadow: 0 0 15px #fff, 0 0 5px var(--theme-color);
    transform: translateX(120%);
}

.cinematic-wrapper.theme-cyber .cinematic-deco-line::before {
    content: "";
    position: absolute;
    bottom: 5px;
    left: 0;
    width: 120%;
    height: 2px;
    background: #fff;
    opacity: 0.5;
    transform: translateX(-120%);
}

/* 텍스트 스타일 */
.cinematic-wrapper.theme-cyber .cinematic-content {
    position: absolute;
    top: 50%;
    left: 5%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
}

.cinematic-wrapper.theme-cyber .cinematic-text-main {
    font-style: normal;
    -webkit-text-stroke: 0;
    text-shadow: 2px 2px 0px var(--theme-color), 0 0 20px var(--theme-color);
    color: var(--main-text-color, #fff);
}

.cinematic-wrapper.theme-cyber .cinematic-text-sub {
    background: rgba(0, 0, 0, 0.6);
    border: 1px solid #fff;
    padding: 2px 15px;
    text-shadow: 0 0 5px #fff;
    margin-left: calc(20px + var(--sub-offset-x, 0px));
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    color: var(--sub-text-color, #fff);
    transform: scaleX(1);
    opacity: 0;
    clip-path: inset(0 100% 0 0);
}

.cinematic-wrapper.theme-cyber.animate .cinematic-paint {
    animation: cyber-bg-seq var(--custom-duration, 3.5s) cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

.cinematic-wrapper.theme-cyber.animate .cinematic-deco-line::after {
    animation: cyber-line-top 0.5s ease-out forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-cyber.animate .cinematic-deco-line::before {
    animation: cyber-line-bottom 0.5s ease-out forwards;
    animation-delay: 0.2s;
}

.cinematic-wrapper.theme-cyber.animate .cinematic-text-main {
    animation: cyber-text-main var(--custom-duration, 3.5s) linear forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-cyber.animate .cinematic-text-sub {
    animation: cyber-text-sub var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.3s;
}


/* ==========================================================================
   3. FORMAT: POPOUT vs BOXED (Layout & Masking)
   ========================================================================== */

/* -------------------------------------------
   A. FORMAT: POPOUT (캐릭터가 화면 밖으로 나옴)
   ------------------------------------------- */
.cinematic-wrapper.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 2;
    overflow: visible;
}

/* [Brush + Popout] */
.cinematic-wrapper.theme-brush.format-popout .cinematic-character {
    bottom: calc(-5% - var(--char-offset-y, 0px));
    right: calc(5% - var(--char-offset-x, 0px));
    height: calc(90% * var(--char-scale, 1));
    max-width: 60%;
    transform: translateX(100%) scale(0.8);
}

/* [Cyber + Popout] */
.cinematic-wrapper.theme-cyber.format-popout .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    right: calc(5% - var(--char-offset-x, 0px));
    height: calc(120% * var(--char-scale, 1));
    width: auto;
    transform: translateX(50px);
}

/* -------------------------------------------
   B. FORMAT: BOXED (캐릭터를 배경 모양대로 자름)
   ------------------------------------------- */
.cinematic-wrapper.format-boxed .char-mask {
    position: absolute;
    z-index: 2;
    overflow: hidden;
}

/* [Brush + Boxed] */
.cinematic-wrapper.theme-brush.format-boxed .char-mask {
    top: 50%;
    left: -10%;
    width: 120%;
    height: 300px;
    transform: translateY(-50%) skewY(-5deg);
    clip-path: polygon(0% 20%, 45% 0%, 100% 15%, 100% 80%, 55% 100%, 0% 85%);
}

.cinematic-wrapper.theme-brush.format-boxed .cinematic-character {
    top: calc(-20% + var(--char-offset-y, 0px));
    right: calc(20% - var(--char-offset-x, 0px));
    height: calc(140% * var(--char-scale, 1));
    width: auto;
    transform: skewY(5deg) translateX(100px);
}

/* [Cyber + Boxed] */
.cinematic-wrapper.theme-cyber.format-boxed .char-mask {
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%);
    clip-path: polygon(5% 0, 100% 0, 100% 80%, 95% 100%, 0 100%, 0 20%);
    overflow: hidden;
}

.cinematic-wrapper.theme-cyber.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(120% * var(--char-scale, 1));
    width: auto;
    transform: translateX(50px);
}

/* ==========================================================================
   4. SHARED ANIMATIONS & KEYFRAMES
   ========================================================================== */

.cinematic-wrapper.theme-brush.format-popout.animate .cinematic-character {
    animation: brush-char-popout var(--custom-duration, 3.5s) cubic-bezier(0.19, 1, 0.22, 1) forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-brush.format-boxed.animate .cinematic-character {
    animation: brush-char-boxed var(--custom-duration, 3.5s) cubic-bezier(0.19, 1, 0.22, 1) forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-cyber.animate .cinematic-character {
    animation: cyber-char-move var(--custom-duration, 3.5s) steps(5, end) forwards;
    animation-delay: 0.05s;
}

/* --- KEYFRAMES (BRUSH) --- */
@keyframes brush-paint-seq {
    0% {
        transform: translateX(-120%) scaleY(0.1);
        opacity: 0;
    }

    10% {
        transform: translateX(0%) scaleY(1);
        opacity: 0.95;
    }

    90% {
        transform: translateX(0%) scaleY(1);
        opacity: 0.95;
    }

    100% {
        transform: translateX(10%) scaleY(0.1);
        opacity: 0;
    }
}

@keyframes brush-char-popout {
    0% {
        transform: translateX(50%) rotate(var(--char-rotate, 0deg)) scale(calc(0.8 * var(--char-mirror-x, 1)), 0.8);
        opacity: 0;
        filter: grayscale(100%) contrast(2);
    }

    10% {
        transform: translateX(0%) rotate(var(--char-rotate, 0deg)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) grayscale(0%) contrast(1);
    }

    90% {
        transform: translateX(-5%) rotate(var(--char-rotate, 0deg)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
        filter: var(--char-shadow-filter) grayscale(0%) contrast(1);
    }

    100% {
        transform: translateX(-10%) rotate(var(--char-rotate, 0deg)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
        filter: var(--char-shadow-filter) grayscale(0%) contrast(1);
    }
}

@keyframes brush-char-boxed {
    0% {
        transform: skewY(5deg) translateX(100px) rotate(var(--char-rotate, 0deg)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
        filter: grayscale(100%) contrast(2);
    }

    10% {
        transform: skewY(5deg) translateX(0) rotate(var(--char-rotate, 0deg)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) grayscale(0%) contrast(1);
    }

    90% {
        transform: skewY(5deg) translateX(-20px) rotate(var(--char-rotate, 0deg)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
        filter: var(--char-shadow-filter) grayscale(0%) contrast(1);
    }

    100% {
        transform: skewY(5deg) translateX(-40px) rotate(var(--char-rotate, 0deg)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
        filter: var(--char-shadow-filter) grayscale(0%) contrast(1);
    }
}

@keyframes brush-text-seq {
    0% {
        opacity: 0;
        transform: translateX(-50px) scale(2);
        filter: blur(10px);
    }

    10% {
        opacity: 1;
        transform: translateX(10px) scale(0.9);
        filter: blur(0);
    }

    15% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }

    90% {
        opacity: 1;
        transform: translateX(0) scale(1);
        filter: blur(0);
    }

    100% {
        opacity: 0;
        transform: translateX(20px) scale(1.1);
        filter: blur(10px);
    }
}

@keyframes brush-sub-seq {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    10% {
        transform: scaleX(1);
        opacity: 1;
    }

    90% {
        transform: scaleX(1);
        opacity: 1;
    }

    100% {
        transform: scaleX(0);
        opacity: 0;
    }
}

@keyframes brush-line-zip {
    0% {
        transform: translateX(120%);
        width: 20%;
    }

    50% {
        transform: translateX(0%);
        width: 100%;
    }

    100% {
        transform: translateX(-120%);
        width: 20%;
    }
}

/* --- KEYFRAMES (CYBER) --- */
@keyframes cyber-bg-seq {
    0% {
        transform: translateX(120%);
        opacity: 0;
    }

    10% {
        transform: translateX(0%);
        opacity: 1;
    }

    90% {
        transform: translateX(0%);
        opacity: 1;
    }

    100% {
        transform: translateX(-10%);
        opacity: 0;
    }
}

@keyframes cyber-char-move {
    0% {
        transform: translateX(50px) rotate(var(--char-rotate)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
        filter: brightness(2) blur(5px);
    }

    10% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1) blur(0);
    }

    15% {
        opacity: 0.5;
    }

    20% {
        opacity: 1;
    }

    90% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1);
    }

    100% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
        filter: var(--char-shadow-filter) brightness(3) blur(10px);
    }
}

@keyframes cyber-line-top {
    0% {
        transform: translateX(120%);
        width: 0%;
    }

    100% {
        transform: translateX(-120%);
        width: 150%;
    }
}

@keyframes cyber-line-bottom {
    0% {
        transform: translateX(-120%);
        width: 0%;
    }

    100% {
        transform: translateX(120%);
        width: 150%;
    }
}

@keyframes cyber-text-main {
    0% {
        opacity: 0;
        transform: translateX(50px);
        letter-spacing: 20px;
    }

    5% {
        opacity: 1;
        transform: translateX(0);
        letter-spacing: 0px;
    }

    90% {
        opacity: 1;
        transform: translateX(0);
        letter-spacing: 0px;
    }

    100% {
        opacity: 0;
        transform: translateX(0);
        letter-spacing: 10px;
        filter: blur(5px);
    }
}

@keyframes cyber-text-sub {
    0% {
        opacity: 0;
        clip-path: inset(0 100% 0 0);
    }

    10% {
        opacity: 1;
        clip-path: inset(0 0 0 0);
    }

    90% {
        opacity: 1;
        clip-path: inset(0 0 0 0);
    }

    100% {
        opacity: 0;
        clip-path: inset(0 0 0 50%);
    }
}

/* ==========================================================================
   5. THEME: CINEMATIC (Movie / Noir) - 가로형 와이드스크린
   ========================================================================== */

.cinematic-wrapper.theme-cinematic .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%);
    filter: none !important;
    z-index: 1;
    /* 가장 뒤 */
}

.cinematic-wrapper.theme-cinematic .cinematic-paint {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, #000 0%, var(--theme-color) 40%, var(--theme-color) 60%, #000 100%);
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.15'/%3E%3C/svg%3E");
    clip-path: inset(0 0 0 0);
    transform: scaleY(0);
    transform-origin: center;
    opacity: 0.95;
}

/* [중요] 선(Border)의 레이어 순서를 설정합니다 */
.cinematic-wrapper.theme-cinematic .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%);
    z-index: 4;
    /* Boxed 캐릭터(3)보다 위, Popout 캐릭터(5)보다 아래 */
    pointer-events: none;
}

.cinematic-wrapper.theme-cinematic .cinematic-deco-line::after,
.cinematic-wrapper.theme-cinematic .cinematic-deco-line::before {
    content: "";
    position: absolute;
    left: 0;
    width: 100%;
    height: 4px;
    background: var(--border-color, #fff);
    box-shadow: 0 0 10px var(--border-color, #fff);
    transform: scaleX(0);
}

.cinematic-wrapper.theme-cinematic .cinematic-deco-line::after {
    top: 0;
}

.cinematic-wrapper.theme-cinematic .cinematic-deco-line::before {
    bottom: 0;
}

.cinematic-wrapper.theme-cinematic .cinematic-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    width: 100%;
    z-index: 10;
    /* 텍스트는 항상 맨 위 */
}

.cinematic-wrapper.theme-cinematic .cinematic-text-main {
    font-style: normal;
    -webkit-text-stroke: 0;
    text-shadow: 0 5px 15px rgba(0, 0, 0, 0.8);
    letter-spacing: 5px;
    margin-left: var(--main-offset-x, 0px);
    margin-top: var(--main-offset-y, 0px);
    color: var(--main-text-color, #fff);
}

.cinematic-wrapper.theme-cinematic .cinematic-text-sub {
    background: transparent;
    font-weight: 300;
    letter-spacing: 10px;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.8);
    border-top: 1px solid rgba(255, 255, 255, 0.5);
    border-bottom: 1px solid rgba(255, 255, 255, 0.5);
    padding: 5px 20px;
    margin-top: calc(10px + var(--sub-offset-y, 0px));
    margin-left: var(--sub-offset-x, 0px);
    transform: scale(1);
    opacity: 0;
    color: var(--sub-text-color, #fff);
}


/* 1. Popout: 캐릭터가 선 밖으로 튀어나옴 */
.cinematic-wrapper.theme-cinematic.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 5;
    /* 선(4)보다 높음 -> 선을 가림 */
    overflow: visible;
    /* 잘리지 않음 */
}

.cinematic-wrapper.theme-cinematic.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    left: calc(5% + var(--char-offset-x, 0px));
    right: auto;
    height: calc(110% * var(--char-scale, 1));
    width: auto;
    margin: 0;
}

/* 2. Boxed: 캐릭터가 선 안(뒤)에 갇힘 */
.cinematic-wrapper.theme-cinematic.format-boxed .char-mask {
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%);
    z-index: 3;
    /* 선(4)보다 낮음 -> 선 뒤에 위치 */
    clip-path: inset(0 0 0 0);
    /* 영역 밖은 칼같이 자름 */
    overflow: hidden;
}

.cinematic-wrapper.theme-cinematic.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    left: calc(5% + var(--char-offset-x, 0px));
    right: auto;
    height: calc(130% * var(--char-scale, 1));
    width: auto;
    margin: 0;
}

.cinematic-wrapper.theme-cinematic.animate .cinematic-paint {
    animation: cine-bg-shutter var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-cinematic.animate .cinematic-deco-line::after,
.cinematic-wrapper.theme-cinematic.animate .cinematic-deco-line::before {
    animation: cine-line-expand var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-cinematic.animate .cinematic-character {
    animation: cine-char-reveal var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0s;
}

.cinematic-wrapper.theme-cinematic.animate .cinematic-text-main {
    animation: cine-text-main var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.2s;
}

.cinematic-wrapper.theme-cinematic.animate .cinematic-text-sub {
    animation: cine-text-sub var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.5s;
}

@keyframes cine-bg-shutter {
    0% {
        transform: scaleY(0);
        opacity: 0;
    }

    10% {
        transform: scaleY(1);
        opacity: 1;
    }

    90% {
        transform: scaleY(1);
        opacity: 1;
    }

    100% {
        transform: scaleY(0);
        opacity: 0;
    }
}

@keyframes cine-line-expand {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    15% {
        transform: scaleX(1);
        opacity: 1;
    }

    90% {
        transform: scaleX(1);
        opacity: 1;
    }

    100% {
        transform: scaleX(0);
        opacity: 0;
    }
}

@keyframes cine-char-reveal {
    0% {
        transform: rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
        filter: brightness(0) grayscale(100%);
    }

    15% {
        transform: rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1) grayscale(0%);
    }

    90% {
        transform: rotate(var(--char-rotate)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1);
    }

    100% {
        transform: rotate(var(--char-rotate)) scale(calc(1.15 * var(--char-mirror-x, 1)), 1.15);
        opacity: 0;
        filter: var(--char-shadow-filter) brightness(0);
    }
}

@keyframes cine-text-main {
    0% {
        opacity: 0;
        transform: scale(1.2);
        letter-spacing: 20px;
        filter: blur(10px);
    }

    15% {
        opacity: 1;
        transform: scale(1);
        letter-spacing: 5px;
        filter: blur(0);
    }

    90% {
        opacity: 1;
        transform: scale(1);
        letter-spacing: 5px;
        filter: blur(0);
    }

    100% {
        opacity: 0;
        transform: scale(0.9);
        letter-spacing: 0px;
        filter: blur(10px);
    }
}

@keyframes cine-text-sub {
    0% {
        opacity: 0;
        transform: translateY(10px);
    }

    10% {
        opacity: 1;
        transform: translateY(0);
    }

    90% {
        opacity: 1;
        transform: translateY(0);
    }

    100% {
        opacity: 0;
        transform: translateY(-10px);
    }
}

/* ==========================================================================
   6. THEME: FANTASY (Royal) - 금장 장식 스타일 (SVG 버전)
   ========================================================================== */

.cinematic-wrapper.theme-royal .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 320px;
    transform: translateY(-50%);
    filter: drop-shadow(0 0 10px var(--border-color, var(--theme-color)));
    z-index: 1;
}

/* 1. 배경: 어두운 색 + 패턴 */
.cinematic-wrapper.theme-royal .cinematic-paint {
    position: absolute;
    top: 0;
    left: 5%;
    width: 90%;
    height: 100%;

    /* 배경색 (어두움) */
    background-color: var(--theme-color, #2c3e50);

    /* 패턴 */
    background-image:
        linear-gradient(135deg, rgba(255, 255, 255, 0.05) 25%, transparent 25%),
        linear-gradient(225deg, rgba(255, 255, 255, 0.05) 25%, transparent 25%),
        linear-gradient(45deg, rgba(255, 255, 255, 0.05) 25%, transparent 25%),
        linear-gradient(315deg, rgba(255, 255, 255, 0.05) 25%, transparent 25%);
    background-size: 20px 20px;

    /* 배경도 육각형으로 자름 */
    clip-path: polygon(0% 50%, 5% 0%, 95% 0%, 100% 50%, 95% 100%, 5% 100%);

    transform: scaleX(0);
    opacity: 0.95;
}

/* 2. 장식선: 캐릭터 뒤 가로선 */
.cinematic-wrapper.theme-royal .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 320px;
    transform: translateY(-50%);
    z-index: 2;
    pointer-events: none;
}

.cinematic-wrapper.theme-royal .cinematic-deco-line::after,
.cinematic-wrapper.theme-royal .cinematic-deco-line::before {
    content: "";
    position: absolute;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, transparent, #fcf6ba, #b38728, transparent);
    transform: scaleX(0);
}

.cinematic-wrapper.theme-royal .cinematic-deco-line::after {
    top: 15%;
}

.cinematic-wrapper.theme-royal .cinematic-deco-line::before {
    bottom: 15%;
}

/* 
   3. 테두리 (Border Layer): SVG 컨테이너 
*/
.cinematic-wrapper.theme-royal .cinematic-border-layer {
    position: absolute;
    top: 50%;
    left: 5%;
    width: 90%;
    height: 320px;
    transform: translateY(-50%);
    pointer-events: none;

    /* 애니메이션용 초기값 */
    transform: translateY(-50%) scaleX(0);
    z-index: 25;
    /* Boxed 모드에선 하단 로직에 의해 60으로 바뀜 */
}

/*  [핵심] SVG 스타일링 */
.cinematic-wrapper.theme-royal .cinematic-border-svg {
    width: 100%;
    height: 100%;
    overflow: visible;
    /* 선 두께가 잘리지 않게 */
}

.cinematic-wrapper.theme-royal .border-poly-royal {
    fill: none;
    /* 내부는 투명 */

    /* 선 색상: 변수가 있으면 변수, 없으면 금색 그라데이션(URL ID) 사용 */
    /* CSS 변수에 그라데이션 URL을 넣을 수 없으므로, 기본은 골드 ID를 쓰고 사용자 지정색이 오면 그걸 덮어씀 */
    stroke: url(#royal-gold-grad);

    /* 선 두께: 사용자 설정값 (기본 2px) */
    stroke-width: var(--border-width, 2px);

    /* [매우 중요] vector-effect: non-scaling-stroke
       이게 있어야 SVG가 늘어나도 선 두께는 픽셀 단위로 일정하게 유지됨 */
    vector-effect: non-scaling-stroke;
}

/* 사용자 지정 보더 색상이 설정된 경우 (기본값이 아닐 때) SVG stroke 재정의 */
/* 단, CSS 변수로 stroke를 직접 제어하려면 var(--border-color)가 단색이어야 함 */
/* 사용자가 색상을 지정했다면 그 색을 사용 */
.cinematic-wrapper.theme-royal[style*="--border-color"] .border-poly-royal {
    stroke: var(--border-color) !important;
}


/* 4. 텍스트 */
.cinematic-wrapper.theme-royal .cinematic-content {
    position: absolute;
    top: 50%;
    left: 10%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    z-index: 10;
}

.cinematic-wrapper.theme-royal .cinematic-text-main {
    font-style: normal;
    -webkit-text-stroke: 1px #4a3b00;
    text-shadow: 0 5px 10px rgba(0, 0, 0, 0.5);
    filter: drop-shadow(0 0 2px rgba(255, 215, 0, 0.5));
    margin-left: var(--main-offset-x, 0px);
    margin-top: var(--main-offset-y, 0px);
    color: var(--main-text-color, #fcf6ba);
}

.cinematic-wrapper.theme-royal .cinematic-text-sub {
    background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.7), transparent);
    border-top: 1px solid #b38728;
    border-bottom: 1px solid #b38728;
    padding: 5px 30px;
    text-shadow: 0 2px 5px #000;
    margin-top: calc(15px + var(--sub-offset-y, 0px));
    margin-left: var(--sub-offset-x, 0px);
    transform: scaleY(0);
    opacity: 0;
    color: var(--sub-text-color, #fcf6ba);
}

/* Formats */
.cinematic-wrapper.theme-royal.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 2;
    overflow: visible;
}

.cinematic-wrapper.theme-royal.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    right: calc(5% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    transform: scale(0.9);
}

.cinematic-wrapper.theme-royal.format-boxed .char-mask {
    top: 50%;
    left: 5%;
    width: 90%;
    height: 320px;
    transform: translateY(-50%);
    clip-path: polygon(0% 50%, 5% 0%, 95% 0%, 100% 50%, 95% 100%, 5% 100%);
    overflow: hidden;
}

.cinematic-wrapper.theme-royal.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(130% * var(--char-scale, 1));
    width: auto;
}

/* Animations */
.cinematic-wrapper.theme-royal.animate .cinematic-paint {
    animation: fantasy-bg-expand var(--custom-duration, 3.5s) cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.cinematic-wrapper.theme-royal.animate .cinematic-deco-line::after,
.cinematic-wrapper.theme-royal.animate .cinematic-deco-line::before {
    animation: fantasy-line-glow var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.2s;
}

/* SVG 테두리 애니메이션 */
.cinematic-wrapper.theme-royal.animate .cinematic-border-layer {
    animation: fantasy-bg-expand-svg var(--custom-duration, 3.5s) cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.cinematic-wrapper.theme-royal.animate .cinematic-character {
    animation: fantasy-char-rise var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-royal.animate .cinematic-text-main {
    animation: fantasy-text-main var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.3s;
}

.cinematic-wrapper.theme-royal.animate .cinematic-text-sub {
    animation: fantasy-text-sub var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.5s;
}

@keyframes fantasy-bg-expand {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    15% {
        transform: scaleX(1);
        opacity: 1;
    }

    90% {
        transform: scaleX(1);
        opacity: 1;
    }

    100% {
        transform: scaleX(0);
        opacity: 0;
    }
}

@keyframes fantasy-bg-expand-svg {
    0% {
        transform: translateY(-50%) scaleX(0);
        opacity: 0;
    }

    15% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }

    90% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }

    100% {
        transform: translateY(-50%) scaleX(0);
        opacity: 0;
    }
}

@keyframes fantasy-line-glow {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    20% {
        transform: scaleX(1);
        opacity: 1;
    }

    90% {
        transform: scaleX(1);
        opacity: 1;
    }

    100% {
        transform: scaleX(0);
        opacity: 0;
    }
}

@keyframes fantasy-char-rise {
    0% {
        transform: translateY(30px) rotate(var(--char-rotate)) scale(calc(0.95 * var(--char-mirror-x, 1)), 0.95);
        opacity: 0;
        filter: brightness(0.5) sepia(1);
    }

    15% {
        transform: translateY(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1) sepia(0);
    }

    90% {
        transform: translateY(-5px) rotate(var(--char-rotate)) scale(calc(1.02 * var(--char-mirror-x, 1)), 1.02);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1.1);
    }

    100% {
        transform: translateY(-10px) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 0;
        filter: var(--char-shadow-filter) brightness(1.5) blur(5px);
    }
}

@keyframes fantasy-text-main {
    0% {
        opacity: 0;
        transform: scale(1.5);
        filter: blur(5px);
    }

    15% {
        opacity: 1;
        transform: scale(1);
        filter: blur(0);
    }

    90% {
        opacity: 1;
        transform: scale(1);
        filter: blur(0);
    }

    100% {
        opacity: 0;
        transform: scale(0.9);
        filter: blur(5px);
    }
}

@keyframes fantasy-text-sub {
    0% {
        transform: scaleY(0);
        opacity: 0;
    }

    15% {
        transform: scaleY(1);
        opacity: 1;
    }

    90% {
        transform: scaleY(1);
        opacity: 1;
    }

    100% {
        transform: scaleY(0);
        opacity: 0;
    }
}

/* 다른 테마에서는 Royal SVG 숨김 */
.cinematic-wrapper:not(.theme-royal) .border-poly-royal {
    display: none;
}

/* ==========================================================================
   7. THEME: SAGA (Real Texture) - 양피지 스타일
   ========================================================================== */

.cinematic-wrapper.theme-saga .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 320px;
    transform: translateY(-50%) rotate(-1deg);
    z-index: 1;
    filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.6)) drop-shadow(0 0 var(--border-width, 0px) var(--border-color, transparent));
}

.cinematic-wrapper.theme-saga .cinematic-paint {
    position: absolute;
    top: 0;
    left: -5%;
    width: 110%;
    height: 100%;
    background-image: url("../assets/cutin-images/tex_paper.jpg");
    background-size: cover;
    background-position: center;
    clip-path: polygon(0% 10%, 2% 0%, 10% 2%, 18% 0%, 25% 3%, 35% 0%, 45% 2%, 55% 0%, 65% 3%, 75% 0%, 85% 2%, 95% 0%, 100% 5%,
            98% 15%, 100% 25%, 97% 35%, 100% 45%, 98% 55%, 100% 65%, 97% 75%, 100% 85%, 98% 95%,
            100% 100%, 90% 98%, 80% 100%, 70% 97%, 60% 100%, 50% 98%, 40% 100%, 30% 97%, 20% 100%, 10% 98%, 0% 100%,
            2% 90%, 0% 80%, 3% 70%, 0% 60%, 2% 50%, 0% 40%, 3% 30%, 0% 20%);
    transform: scaleX(0);
    transform-origin: center;
}

.cinematic-wrapper.theme-saga .cinematic-paint::before {
    content: "";
    position: absolute;
    inset: 0;
    background: var(--theme-color);
    mix-blend-mode: overlay;
    opacity: 0.6;
}

.cinematic-wrapper.theme-saga .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 320px;
    transform: translateY(-50%) rotate(-1deg);
    pointer-events: none;
    z-index: 1;
}

.cinematic-wrapper.theme-saga .cinematic-deco-line::before {
    content: "";
    position: absolute;
    inset: 0;
    background-image: url("../assets/cutin-images/tex_grunge.jpg");
    background-size: cover;
    mix-blend-mode: multiply;
    opacity: 0.4;
    transform: scaleX(0);
    transform-origin: center;
}

.cinematic-wrapper.theme-saga .cinematic-deco-line::after {
    content: "";
    position: absolute;
    top: 5%;
    right: 2%;
    width: 400px;
    height: 150px;
    background-image: url("../assets/cutin-images/tex_dragon_walk.png");
    background-size: contain;
    background-repeat: no-repeat;
    background-position: top right;
    mix-blend-mode: multiply;
    opacity: 0.7;
    filter: contrast(1.2);
    transform: scaleX(0);
    transform-origin: right;
}

.cinematic-wrapper.theme-saga .cinematic-content {
    position: absolute;
    top: 50%;
    left: 10%;
    transform: translateY(-50%) rotate(-1deg);
    display: flex;
    flex-direction: column;
    z-index: 10;
}

.cinematic-wrapper.theme-saga .cinematic-text-main {
    font-style: normal;
    -webkit-text-stroke: 0;
    text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.4), 0 0 2px rgba(43, 27, 23, 0.3);
    margin-left: var(--main-offset-x, 0px);
    margin-top: var(--main-offset-y, 0px);
    opacity: 0;
    color: var(--main-text-color, rgba(43, 27, 23, 0.95));
}

.cinematic-wrapper.theme-saga .cinematic-text-sub {
    background: transparent;
    font-weight: bold;
    border-top: 2px solid #4a3b32;
    border-bottom: 2px solid #4a3b32;
    padding: 5px 20px;
    transform: rotate(1deg) scaleX(0);
    transform-origin: left;
    margin-top: calc(15px + var(--sub-offset-y, 0px));
    margin-left: var(--sub-offset-x, 0px);
    z-index: 10;
    color: var(--sub-text-color, #4a3b32);
}

/* Saga Formats */
.cinematic-wrapper.theme-saga.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 2;
    overflow: visible;
}

.cinematic-wrapper.theme-saga.format-popout .cinematic-character {
    filter: var(--char-shadow-filter) sepia(0.2) contrast(1.1);
    bottom: calc(-10% - var(--char-offset-y, 0px));
    right: calc(5% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    transform: scale(0.95);
}

.cinematic-wrapper.theme-saga.format-boxed .char-mask {
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%) rotate(-1deg);
    clip-path: polygon(2% 0%, 98% 2%, 100% 95%, 50% 100%, 0% 98%);
    overflow: hidden;
}

.cinematic-wrapper.theme-saga.format-boxed .cinematic-character {
    mix-blend-mode: multiply;
    opacity: 0.9;
    filter: var(--char-shadow-filter) sepia(0.5) contrast(1.2) brightness(0.9);
    top: calc(-10% + var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(130% * var(--char-scale, 1));
    width: auto;
}

.cinematic-wrapper.theme-saga.animate .cinematic-paint {
    animation: saga-unroll var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-saga.animate .cinematic-deco-line::after {
    animation: saga-unroll var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-saga.animate .cinematic-character {
    animation: saga-ink-reveal var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.3s;
}

.cinematic-wrapper.theme-saga.format-boxed.animate .cinematic-character {
    animation: saga-ink-reveal-boxed var(--custom-duration, 3.5s) ease-out forwards;
}

.cinematic-wrapper.theme-saga.animate .cinematic-text-main {
    animation: saga-text-stamp var(--custom-duration, 3.5s) cubic-bezier(0.5, 0, 0.75, 0) forwards;
    animation-delay: 0.5s;
}

.cinematic-wrapper.theme-saga.animate .cinematic-text-sub {
    animation: saga-sub-write var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.8s;
}

@keyframes saga-unroll {
    0% {
        transform: scaleX(0);
    }

    10% {
        transform: scaleX(1);
    }

    90% {
        transform: scaleX(1);
    }

    100% {
        transform: scaleX(0);
    }
}

@keyframes saga-ink-reveal {
    0% {
        opacity: 0;
        filter: var(--char-shadow-filter) sepia(1) blur(10px);
        transform: rotate(var(--char-rotate)) scale(calc(0.95 * var(--char-mirror-x, 1)), 0.95);
    }

    10% {
        opacity: 1;
        filter: var(--char-shadow-filter) sepia(0.2) blur(0);
        transform: rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
    }

    90% {
        opacity: 1;
        filter: var(--char-shadow-filter) sepia(0.2) blur(0);
        transform: rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
    }

    100% {
        opacity: 0;
        filter: var(--char-shadow-filter) sepia(1) blur(10px);
        transform: rotate(var(--char-rotate)) scale(calc(0.95 * var(--char-mirror-x, 1)), 0.95);
    }
}

@keyframes saga-ink-reveal-boxed {
    0% {
        opacity: 0;
        filter: var(--char-shadow-filter) sepia(0.8) blur(5px);
        transform: rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
    }

    10% {
        opacity: 0.9;
        filter: var(--char-shadow-filter) sepia(0.5) blur(0);
        transform: rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
    }

    90% {
        opacity: 0.9;
        filter: var(--char-shadow-filter) sepia(0.5) blur(0);
        transform: rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
    }

    100% {
        opacity: 0;
        filter: var(--char-shadow-filter) sepia(0.8) blur(5px);
        transform: rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
    }
}

@keyframes saga-text-stamp {
    0% {
        opacity: 0;
        transform: scale(2);
    }

    10% {
        opacity: 1;
        transform: scale(0.9);
    }

    15% {
        opacity: 1;
        transform: scale(1);
    }

    90% {
        opacity: 1;
        transform: scale(1);
    }

    100% {
        opacity: 0;
        transform: scale(2);
    }
}

@keyframes saga-sub-write {
    0% {
        transform: rotate(1deg) scaleX(0);
        opacity: 0;
    }

    15% {
        transform: rotate(1deg) scaleX(1);
        opacity: 1;
    }

    90% {
        transform: rotate(1deg) scaleX(1);
        opacity: 1;
    }

    100% {
        transform: rotate(1deg) scaleX(0);
        opacity: 0;
    }
}

/* ==========================================================================
   8. THEME: TRIBAL (Dragon / Monster)
   ========================================================================== */

.cinematic-wrapper.theme-tribal .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%) rotate(2deg);
    filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.6)) drop-shadow(0 0 var(--border-width, 0px) var(--border-color, transparent));
    z-index: 1;
}

.cinematic-wrapper.theme-tribal .cinematic-paint {
    position: absolute;
    top: 0;
    left: -10%;
    width: 120%;
    height: 100%;
    background: #1a1a1a;
    clip-path: polygon(0% 10%, 15% 0%, 30% 15%, 45% 5%, 60% 20%, 75% 0%, 90% 15%, 100% 0%, 100% 80%, 85% 100%, 70% 85%, 55% 100%, 40% 80%, 25% 100%, 10% 85%, 0% 100%);
    transform: translateX(-120%);
    opacity: 0.95;
}

.cinematic-wrapper.theme-tribal .cinematic-paint::before {
    content: "";
    position: absolute;
    inset: 0;
    background-color: var(--theme-color);
    -webkit-mask-image: url("../assets/cutin-images/tex_dragon_bg.png");
    mask-image: url("../assets/cutin-images/tex_dragon_bg.png");
    -webkit-mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    -webkit-mask-position: 20% center;
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: 20% center;
    opacity: 0.5;
    mix-blend-mode: screen;
    pointer-events: none;
}

.cinematic-wrapper.theme-tribal .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%) rotate(2deg);
    pointer-events: none;
    z-index: 1;
}

.cinematic-wrapper.theme-tribal .cinematic-deco-line::after {
    content: "";
    position: absolute;
    top: -40%;
    right: 0%;
    width: 450px;
    height: 450px;
    background-color: #fff;
    -webkit-mask-image: url("../assets/cutin-images/tex_dragon_deco.png");
    mask-image: url("../assets/cutin-images/tex_dragon_deco.png");
    -webkit-mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    mask-size: contain;
    mask-repeat: no-repeat;
    filter: drop-shadow(0 0 5px var(--theme-color));
    transform: scale(0) rotate(-10deg);
    /* 초기 상태 0 */
}

.cinematic-wrapper.theme-tribal .cinematic-content {
    position: absolute;
    top: 50%;
    left: 15%;
    transform: translateY(-50%) rotate(2deg);
    display: flex;
    flex-direction: column;
    z-index: 3;
}

.cinematic-wrapper.theme-tribal .cinematic-text-main {
    font-style: italic;
    font-weight: 900;
    -webkit-text-stroke: 0;
    text-shadow: 3px 3px 0 var(--theme-color), -1px -1px 0 #000;
    margin-left: var(--main-offset-x, 0px);
    margin-top: var(--main-offset-y, 0px);
    opacity: 0;
    color: var(--main-text-color, #fff);
}

.cinematic-wrapper.theme-tribal .cinematic-text-sub {
    background: var(--theme-color);
    padding: 2px 15px;
    clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%);
    margin-top: calc(10px + var(--sub-offset-y, 0px));
    margin-left: var(--sub-offset-x, 0px);
    transform: translateX(-50px);
    opacity: 0;
    color: var(--sub-text-color, #000);
}

/* Tribal Formats (유지) */
.cinematic-wrapper.theme-tribal.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 2;
    overflow: visible;
}

.cinematic-wrapper.theme-tribal.format-popout .cinematic-character {
    filter: var(--char-shadow-filter) contrast(1.2);
    bottom: calc(-5% - var(--char-offset-y, 0px));
    right: calc(5% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    transform: scale(0.9) translateX(50px);
}

.cinematic-wrapper.theme-tribal.format-boxed .char-mask {
    /* Paint와 동일한 좌표/크기로 수정 (중요: -10%, 120%) */
    top: 50%;
    left: -10%;
    width: 120%;
    height: 350px;
    transform: translateY(-50%) rotate(2deg);

    /* Polygon 좌표는 Paint와 동일 */
    clip-path: polygon(0% 10%, 15% 0%, 30% 15%, 45% 5%, 60% 20%, 75% 0%, 90% 15%, 100% 0%, 100% 80%, 85% 100%, 70% 85%, 55% 100%, 40% 80%, 25% 100%, 10% 85%, 0% 100%);
    overflow: hidden;
}

.cinematic-wrapper.theme-tribal.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(130% * var(--char-scale, 1));
    width: auto;
    transform: translateX(50px);
}

/* Tribal 애니메이션 */
.cinematic-wrapper.theme-tribal.animate .cinematic-paint {
    animation: tribal-slash var(--custom-duration, 3.5s) cubic-bezier(0.1, 0.9, 0.2, 1) forwards;
}

.cinematic-wrapper.theme-tribal.animate .cinematic-deco-line::after {
    animation: tribal-stamp 0.4s cubic-bezier(0.5, 0, 0.75, 0) forwards;
    animation-delay: 0.4s;
}

.cinematic-wrapper.theme-tribal.animate .cinematic-character {
    animation: tribal-char-rush var(--custom-duration, 3.5s) cubic-bezier(0.19, 1, 0.22, 1) forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-tribal.animate .cinematic-text-main {
    animation: tribal-text-hit var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.3s;
}

.cinematic-wrapper.theme-tribal.animate .cinematic-text-sub {
    animation: tribal-sub-slide var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.5s;
}

/* Keyframes */
@keyframes tribal-slash {
    0% {
        transform: translateX(-120%) skewX(-20deg);
    }

    10% {
        transform: translateX(0%) skewX(0deg);
    }

    90% {
        transform: translateX(0%) skewX(0deg);
    }

    100% {
        transform: translateX(120%) skewX(20deg);
    }
}

@keyframes tribal-char-rush {
    0% {
        transform: translateX(50%) rotate(var(--char-rotate)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
    }

    15% {
        transform: translateX(0%) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: translateX(-5%) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
    }

    100% {
        transform: translateX(-10%) rotate(var(--char-rotate)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
    }
}

@keyframes tribal-text-hit {
    0% {
        transform: translateX(-100px);
        opacity: 0;
    }

    10% {
        transform: translateX(10px);
        opacity: 1;
    }

    15% {
        transform: translateX(0);
        opacity: 1;
    }

    90% {
        transform: translateX(0);
        opacity: 1;
    }

    100% {
        transform: translateX(100px);
        opacity: 0;
    }
}

@keyframes tribal-sub-slide {
    0% {
        transform: translateX(-50px);
        opacity: 0;
    }

    15% {
        transform: translateX(0);
        opacity: 1;
    }

    90% {
        transform: translateX(0);
        opacity: 1;
    }

    100% {
        transform: translateX(50px);
        opacity: 0;
    }
}

@keyframes tribal-stamp {
    0% {
        transform: scale(3) rotate(-10deg);
        opacity: 0;
    }

    100% {
        transform: scale(1) rotate(-10deg);
        opacity: 1;
    }
}

/* ==========================================================================
   9. THEME: IMPACT (Left Char / Right Text)
   ========================================================================== */

.cinematic-wrapper.theme-impact .cinematic-bg-layer {
    position: absolute;
    top: 60%;
    left: -10%;
    width: 120%;
    height: 600px;
    transform: translateY(-50%) rotate(-7deg);
    z-index: 1;
    background: #000;
    clip-path: polygon(0% 45%, 10% 40%, 20% 48%, 30% 35%, 40% 45%, 50% 20%, 60% 40%, 70% 10%, 80% 35%, 90% 0%, 100% 15%, 100% 85%, 90% 100%, 80% 65%, 70% 90%, 60% 60%, 50% 80%, 40% 55%, 30% 65%, 20% 52%, 10% 58%, 0% 55%);
    transform-origin: left center;
}

.cinematic-wrapper.theme-impact .cinematic-deco-line {
    position: absolute;
    top: 60%;
    left: -10%;
    width: 120%;
    height: 570px;
    transform: translateY(-50%) rotate(-7deg);
    z-index: 2;
    background: #fff;
    clip-path: polygon(0% 46%, 10% 41%, 20% 49%, 30% 36%, 40% 46%, 50% 21%, 60% 41%, 70% 11%, 80% 36%, 90% 1%, 100% 16%, 100% 84%, 90% 99%, 80% 66%, 70% 89%, 60% 61%, 50% 79%, 40% 56%, 30% 64%, 20% 53%, 10% 57%, 0% 54%);
    transform-origin: left center;
}

.cinematic-wrapper.theme-impact .cinematic-paint {
    position: absolute;
    top: 60%;
    left: -10%;
    width: 120%;
    height: 540px;
    transform: translateY(-50%) rotate(-7deg);
    z-index: 3;
    background-color: var(--theme-color);
    background-image: radial-gradient(rgba(0, 0, 0, 0.3) 20%, transparent 20%), radial-gradient(rgba(255, 255, 255, 0.1) 20%, transparent 20%);
    background-size: 10px 10px;
    clip-path: polygon(1% 47%, 10% 43%, 20% 50%, 30% 38%, 40% 47%, 50% 23%, 60% 43%, 70% 13%, 80% 38%, 90% 3%, 99% 18%, 99% 82%, 90% 97%, 80% 68%, 70% 87%, 60% 63%, 50% 77%, 40% 58%, 30% 62%, 20% 55%, 10% 56%, 1% 53%);
    transform-origin: left center;
}

.cinematic-wrapper.theme-impact .char-mask {
    position: absolute;
    top: 60%;
    left: -10%;
    width: 120%;
    height: 540px;
    transform: translateY(-50%) rotate(-7deg);
    z-index: 4;
    pointer-events: none;
    overflow: visible;
    transform-origin: left center;
}

.cinematic-wrapper.theme-impact .cinematic-character {
    position: absolute;
    top: calc(0% + var(--char-offset-y, 0px));
    left: calc(-15% + var(--char-offset-x, 0px));
    width: calc(100% * var(--char-scale, 1));
    max-width: none !important;
    height: auto;
    object-fit: cover;
    filter: contrast(1.2) drop-shadow(5px 5px 10px rgba(0, 0, 0, 0.5));
}

.cinematic-wrapper.theme-impact.format-boxed .char-mask {
    clip-path: polygon(1% 47%, 10% 43%, 20% 50%, 30% 38%, 40% 47%, 50% 23%, 60% 43%, 70% 13%, 80% 38%, 90% 3%, 99% 18%, 99% 82%, 90% 97%, 80% 68%, 70% 87%, 60% 63%, 50% 77%, 40% 58%, 30% 62%, 20% 55%, 10% 56%, 1% 53%);
    overflow: hidden;
}

.cinematic-wrapper.theme-impact.format-popout .char-mask {
    clip-path: none;
    overflow: visible;
}

.cinematic-wrapper.theme-impact.format-popout .cinematic-character {
    z-index: 5;
}

.cinematic-wrapper.theme-impact .cinematic-content {
    position: absolute;
    top: 30%;
    left: 80%;
    transform: translate(-50%, -50%) rotate(-7deg);
    z-index: 10;
    width: 100%;
    text-align: center;
}

.cinematic-wrapper.theme-impact .cinematic-text-main {
    font-family: 'Teko', sans-serif;
    font-style: italic;
    font-weight: 900;
    font-size: var(--main-font-size, 8rem);
    color: var(--main-text-color, #fff);
    letter-spacing: -2px;
    line-height: 0.8;
    text-shadow: 3px 3px 0 #000, 6px 6px 0 var(--theme-color);
    transform: scale(3) translateX(-50px);
    opacity: 0;
}

.cinematic-wrapper.theme-impact .cinematic-text-sub {
    display: inline-block;
    background: #000;
    color: var(--sub-text-color, #fff);
    transform: skewX(-20deg) scale(0);
    padding: 5px 30px;
    margin-top: calc(20px + var(--sub-offset-y, 0px));
    margin-left: var(--sub-offset-x, 0px);
    font-size: var(--sub-font-size, 3rem);
    font-weight: 700;
    border: 3px solid #fff;
    box-shadow: 5px 5px 0 var(--theme-color);
}

/* Impact 애니메이션 */
.cinematic-wrapper.theme-impact.animate .cinematic-bg-layer {
    animation: impact-wedge-tear var(--custom-duration, 3.5s) cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
}

.cinematic-wrapper.theme-impact.animate .cinematic-deco-line {
    animation: impact-wedge-tear var(--custom-duration, 3.5s) cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-impact.animate .cinematic-paint {
    animation: impact-wedge-tear var(--custom-duration, 3.5s) cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    animation-delay: 0.15s;
}

.cinematic-wrapper.theme-impact.animate .cinematic-character {
    animation: impact-char-pop var(--custom-duration, 3.5s) cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    animation-delay: 0.2s;
}

.cinematic-wrapper.theme-impact.animate .cinematic-text-main {
    animation: impact-text-crash var(--custom-duration, 3.5s) cubic-bezier(0.5, 0, 0.75, 0) forwards;
    animation-delay: 0.4s;
}

.cinematic-wrapper.theme-impact.animate .cinematic-text-sub {
    animation: impact-sub-pop var(--custom-duration, 3.5s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    animation-delay: 0.6s;
}

@keyframes impact-wedge-tear {
    0% {
        transform: translateY(-50%) rotate(-7deg) scaleX(0);
    }

    10% {
        transform: translateY(-50%) rotate(-7deg) scaleX(1);
    }

    90% {
        transform: translateY(-50%) rotate(-7deg) scaleX(1);
    }

    100% {
        transform: translateY(-50%) rotate(-7deg) scaleX(0);
    }
}

@keyframes impact-char-pop {
    0% {
        transform: translateX(-50px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
    }

    10% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    100% {
        transform: translateX(-50px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
    }
}

@keyframes impact-text-crash {
    0% {
        transform: scale(3) translateX(-50px) rotate(-5deg);
        opacity: 0;
    }

    10% {
        transform: scale(0.9) translateX(0) rotate(0deg);
        opacity: 1;
    }

    15% {
        transform: scale(1) translateX(0) rotate(0deg);
        opacity: 1;
    }

    90% {
        transform: scale(1) translateX(0) rotate(0deg);
        opacity: 1;
    }

    100% {
        transform: scale(3) translateX(50px) rotate(5deg);
        opacity: 0;
    }
}

@keyframes impact-sub-pop {
    0% {
        transform: skewX(-20deg) scale(0);
        opacity: 0;
    }

    15% {
        transform: skewX(-20deg) scale(1.1);
        opacity: 1;
    }

    20% {
        transform: skewX(-20deg) scale(1);
        opacity: 1;
    }

    90% {
        transform: skewX(-20deg) scale(1);
        opacity: 1;
    }

    100% {
        transform: skewX(-20deg) scale(0);
        opacity: 0;
    }
}

#preview-stage.theme-impact .cinematic-paint {
    background-size: 25px 25px !important;
}

/* ==========================================================================
   10. THEME: PHANTOM (Stylish / Halftone)
   ========================================================================== */

.cinematic-wrapper.theme-phantom .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: -10%;
    width: 120%;
    height: 350px;
    transform: translateY(-50%) rotate(-5deg);
    filter: drop-shadow(10px 10px 0px rgba(0, 0, 0, 1));
    z-index: 1;
}

.cinematic-wrapper.theme-phantom .cinematic-paint {
    position: absolute;
    inset: 0;
    background-color: var(--theme-color, #e61c34);
    background-image: radial-gradient(circle, rgba(0, 0, 0, 0.3) 2px, transparent 2.5px);
    background-size: 15px 15px;
    clip-path: polygon(0% 10%, 15% 0%, 25% 15%, 40% 5%, 50% 20%, 65% 0%, 80% 15%, 100% 0%, 100% 90%, 85% 100%, 75% 85%, 60% 100%, 45% 85%, 30% 100%, 15% 85%, 0% 100%);
    transform: translateX(-120%);
}

.cinematic-wrapper.theme-phantom .cinematic-deco-line {
    position: absolute;
    top: var(--screen-y, 50%);
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%) rotate(-5deg);
    pointer-events: none;
    z-index: 2;
}

.cinematic-wrapper.theme-phantom .cinematic-deco-line::after {
    content: "★";
    font-size: 10rem;
    color: #fff;
    position: absolute;
    /* 띠의 top(0%) 기준에서 살짝 위(-20%)로 배치 */
    top: -20%;
    right: 15%;
    text-shadow: 8px 8px 0 #000;
    transform: scale(0) rotate(180deg);
    opacity: 0.8;
}

.cinematic-wrapper.theme-phantom .cinematic-deco-line::before {
    content: "★";
    font-size: 7rem;
    color: #000;
    position: absolute;
    /* bottom 대신 top으로 통일해서 계산 실수 방지 */
    /* 띠의 바닥(100%) 기준에서 살짝 위(80%) 혹은 아래(110%)로 조정 */
    top: 85%;
    left: 18%;
    filter: drop-shadow(0 0 5px #fff);
    transform: scale(0) rotate(-180deg);
    opacity: 0.6;
}

.cinematic-wrapper.theme-phantom .cinematic-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-5deg);
    z-index: 10;
    text-align: center;
}

.cinematic-wrapper.theme-phantom .cinematic-text-main {
    font-style: italic;
    font-weight: 900;
    color: #fff;
    -webkit-text-stroke: 2px #000;
    text-shadow: 5px 5px 0 var(--theme-color);
    transform: scale(0) skewX(-20deg);
}

.cinematic-wrapper.theme-phantom .cinematic-text-sub {
    background: #000;
    color: #fff;
    padding: 5px 20px;
    transform: rotate(3deg) scale(0);
    box-shadow: 5px 5px 0 #fff;
    font-weight: bold;
}

/* Phantom 애니메이션 */
.cinematic-wrapper.theme-phantom.animate .cinematic-paint {
    animation: phantom-slide var(--custom-duration, 3.5s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

.cinematic-wrapper.theme-phantom.animate .cinematic-deco-line::after {
    animation: phantom-star-spin 0.6s cubic-bezier(0.5, 0, 0.75, 0) forwards 0.3s;
}

.cinematic-wrapper.theme-phantom.animate .cinematic-deco-line::before {
    animation: phantom-star-spin 0.6s cubic-bezier(0.5, 0, 0.75, 0) forwards 0.4s;
}

.cinematic-wrapper.theme-phantom.animate .cinematic-text-main {
    animation: phantom-text-pop var(--custom-duration, 3.5s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.2s;
}

.cinematic-wrapper.theme-phantom.animate .cinematic-text-sub {
    animation: phantom-text-pop var(--custom-duration, 3.5s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.4s;
}

@keyframes phantom-slide {
    0% {
        transform: translateX(-120%);
    }

    10% {
        transform: translateX(0%);
    }

    90% {
        transform: translateX(0%);
    }

    100% {
        transform: translateX(120%);
    }
}

@keyframes phantom-star-spin {
    0% {
        transform: scale(0) rotate(180deg);
        opacity: 0;
    }

    80% {
        transform: scale(1.2) rotate(0deg);
        opacity: 1;
    }

    100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
}

@keyframes phantom-text-pop {
    0% {
        transform: scale(0) skewX(-20deg);
        opacity: 0;
    }

    10% {
        transform: scale(1) skewX(-20deg);
        opacity: 1;
    }

    90% {
        transform: scale(1) skewX(-20deg);
        opacity: 1;
    }

    100% {
        transform: scale(0) skewX(-20deg);
        opacity: 0;
    }
}

/* Phantom Formats */
.cinematic-wrapper.theme-phantom.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 5;
    overflow: visible;
}

.cinematic-wrapper.theme-phantom.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    right: calc(5% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    filter: var(--char-shadow-filter) contrast(1.2) brightness(1.1);
    transform: translateX(100px) scale(0.9);
    opacity: 0;
}

.cinematic-wrapper.theme-phantom.format-boxed .char-mask {
    position: absolute;
    top: 50%;
    left: -10%;
    width: 120%;
    height: 350px;
    transform: translateY(-50%) rotate(-5deg);
    z-index: 5;
    clip-path: polygon(0% 10%, 15% 0%, 25% 15%, 40% 5%, 50% 20%, 65% 0%, 80% 15%, 100% 0%, 100% 90%, 85% 100%, 75% 85%, 60% 100%, 45% 85%, 30% 100%, 15% 85%, 0% 100%);
    overflow: hidden;
}

.cinematic-wrapper.theme-phantom.format-boxed .cinematic-character {
    top: calc(-15% + var(--char-offset-y, 0px));
    right: calc(20% - var(--char-offset-x, 0px));
    height: calc(140% * var(--char-scale, 1));
    width: auto;
    transform: rotate(5deg) scale(0.95);
    filter: var(--char-shadow-filter) contrast(1.2);
    opacity: 0;
}

.cinematic-wrapper.theme-phantom.format-popout.animate .cinematic-character {
    animation: phantom-char-pop var(--custom-duration, 3.5s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.1s;
}

.cinematic-wrapper.theme-phantom.format-boxed.animate .cinematic-character {
    animation: phantom-char-boxed var(--custom-duration, 3.5s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.1s;
}

@keyframes phantom-char-pop {
    0% {
        transform: translateX(100px) rotate(var(--char-rotate)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
    }

    10% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    100% {
        transform: translateX(100px) rotate(var(--char-rotate)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
    }
}

@keyframes phantom-char-boxed {

    /* 기존 5도 기울기에 사용자 회전값 추가 */
    0% {
        transform: rotate(calc(5deg + var(--char-rotate))) translateX(50px) scale(calc(0.95 * var(--char-mirror-x, 1)), 0.95);
        opacity: 0;
    }

    10% {
        transform: rotate(calc(5deg + var(--char-rotate))) translateX(0) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: rotate(calc(5deg + var(--char-rotate))) translateX(0) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    100% {
        transform: rotate(calc(5deg + var(--char-rotate))) translateX(50px) scale(calc(0.95 * var(--char-mirror-x, 1)), 0.95);
        opacity: 0;
    }
}

#preview-stage.theme-phantom .cinematic-paint {
    background-image: radial-gradient(circle, rgba(0, 0, 0, 0.3) 4px, transparent 5px) !important;
    background-size: 30px 30px !important;
}

/* ==========================================================================
   11. THEME: ARCANE (Magic / Fantasy / Glow) (변수 적용 수정됨)
   ========================================================================== */

.cinematic-wrapper.theme-arcane .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 400px;
    transform: translateY(-50%);
    z-index: 1;
    filter: drop-shadow(0 0 20px var(--theme-color));
}

.cinematic-wrapper.theme-arcane .cinematic-paint {
    position: absolute;
    top: 10%;
    left: 0;
    width: 100%;
    height: 80%;
    background: radial-gradient(circle, rgba(0, 0, 0, 0.8) 0%, transparent 100%);
    transform: scaleX(0);
    transform-origin: center;
    opacity: 0.9;
}

/* [장식선] 마법진 - 항상 캐릭터 뒤 (Z: 20) */
.cinematic-wrapper.theme-arcane .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 600px;
    height: 600px;
    transform: translate(-50%, -50%);
    z-index: 2;
    pointer-events: none;
}

.cinematic-wrapper.theme-arcane .cinematic-deco-line::after {
    content: "";
    position: absolute;
    inset: 0;
    border: 2px dashed var(--theme-color);
    border-radius: 50%;
    box-shadow: 0 0 30px var(--theme-color);
    opacity: 0;
}

.cinematic-wrapper.theme-arcane .cinematic-deco-line::before {
    content: "";
    position: absolute;
    inset: 15%;
    border: 1px solid #fff;
    border-radius: 50%;
    opacity: 0;
}

/* [테두리] 상하단 라인 - Boxed시 캐릭터 앞 (Z: 60) */
/*   보더 두께/색상 변수 적용 */
.cinematic-wrapper.theme-arcane .cinematic-border-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 400px;
    transform: translateY(-50%);
    pointer-events: none;
}

.cinematic-wrapper.theme-arcane .cinematic-border-layer::before {
    content: "";
    position: absolute;
    top: 10%;
    bottom: 10%;
    left: 0;
    right: 0;

    /* 두께: 기본 2px + 설정값 */
    border-top: calc(2px + var(--border-width, 0px)) solid var(--border-color, var(--theme-color));
    border-bottom: calc(2px + var(--border-width, 0px)) solid var(--border-color, var(--theme-color));

    transform: scaleX(0);
    opacity: 0;
}

.cinematic-wrapper.theme-arcane .cinematic-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    text-align: center;
    width: 100%;
}

/*   텍스트 색상 변수 적용 */
.cinematic-wrapper.theme-arcane .cinematic-text-main {
    font-family: serif;
    font-weight: bold;
    /* 그라데이션 제거 -> 사용자 지정 색상 적용 */
    color: var(--main-text-color, #fff);
    text-shadow: 0 0 10px var(--theme-color), 0 0 20px var(--theme-color);

    transform: translateY(20px);
    opacity: 0;
    letter-spacing: 5px;
}

/*   서브 텍스트 색상 및 구분선 변수 적용 */
.cinematic-wrapper.theme-arcane .cinematic-text-sub {
    font-family: serif;
    color: var(--sub-text-color, #fff);

    /* 구분선도 보더 컬러를 따라가게 수정 (투명도 적용) */
    border-top: 1px solid var(--border-color, rgba(255, 255, 255, 0.5));
    border-bottom: 1px solid var(--border-color, rgba(255, 255, 255, 0.5));

    padding: 5px 30px;
    margin-top: 10px;
    transform: scaleX(0);
    opacity: 0;
}

/* Arcane 애니메이션 */
.cinematic-wrapper.theme-arcane.animate .cinematic-paint {
    animation: arcane-bg-expand var(--custom-duration, 3.5s) ease-out forwards;
}

.cinematic-wrapper.theme-arcane.animate .cinematic-border-layer::before {
    animation: arcane-bg-expand var(--custom-duration, 3.5s) ease-out forwards;
}

.cinematic-wrapper.theme-arcane.animate .cinematic-deco-line::after {
    animation: arcane-circle-spin 4s linear infinite, arcane-circle-lifecycle var(--custom-duration, 3.5s) ease-out forwards;
}

.cinematic-wrapper.theme-arcane.animate .cinematic-deco-line::before {
    animation: arcane-circle-spin-rev 4s linear infinite, arcane-circle-lifecycle var(--custom-duration, 3.5s) ease-out forwards 0.2s;
}

.cinematic-wrapper.theme-arcane.animate .cinematic-text-main {
    animation: arcane-text-rise var(--custom-duration, 3.5s) ease-out forwards 0.3s;
}

.cinematic-wrapper.theme-arcane.animate .cinematic-text-sub {
    animation: arcane-sub-expand var(--custom-duration, 3.5s) ease-out forwards 0.5s;
}

@keyframes arcane-bg-expand {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    10% {
        transform: scaleX(1);
        opacity: 0.9;
    }

    90% {
        transform: scaleX(1);
        opacity: 0.9;
    }

    100% {
        transform: scaleX(0);
        opacity: 0;
    }
}

@keyframes arcane-circle-spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

@keyframes arcane-circle-spin-rev {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(-360deg);
    }
}

@keyframes arcane-circle-lifecycle {
    0% {
        opacity: 0;
        scale: 0.8;
    }

    15% {
        opacity: 0.4;
        scale: 1;
    }

    90% {
        opacity: 0.4;
        scale: 1;
    }

    100% {
        opacity: 0;
        scale: 1.2;
    }
}

@keyframes arcane-text-rise {
    0% {
        opacity: 0;
        transform: translateY(20px) scale(0.9);
    }

    15% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    90% {
        opacity: 1;
        transform: translateY(0) scale(1);
        filter: drop-shadow(0 0 20px var(--theme-color));
    }

    100% {
        opacity: 0;
        transform: translateY(-10px);
        filter: blur(5px);
    }
}

@keyframes arcane-sub-expand {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    15% {
        transform: scaleX(1);
        opacity: 1;
    }

    90% {
        transform: scaleX(1);
        opacity: 1;
    }

    100% {
        transform: scaleX(0);
        opacity: 0;
    }
}

/* Arcane Formats */
.cinematic-wrapper.theme-arcane.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 5;
    overflow: visible;
}

.cinematic-wrapper.theme-arcane.format-popout .cinematic-character {
    bottom: calc(0% - var(--char-offset-y, 0px));
    left: 50%;
    margin-left: calc(-25vh - var(--char-offset-x, 0px));
    height: calc(90% * var(--char-scale, 1));
    width: auto;
    filter: var(--char-shadow-filter) drop-shadow(0 0 15px var(--theme-color)) brightness(1.1);
    transform: translateY(50px) scale(0.95);
    opacity: 0;
}

.cinematic-wrapper.theme-arcane.format-boxed .char-mask {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 400px;
    transform: translateY(-50%);
    z-index: 5;
    clip-path: inset(10% 0 10% 0);
    overflow: hidden;
}

.cinematic-wrapper.theme-arcane.format-boxed .cinematic-character {
    position: absolute;
    top: calc(0% + var(--char-offset-y, 0px));
    left: 50%;
    margin-left: calc(-20vh - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    filter: var(--char-shadow-filter) drop-shadow(0 0 10px var(--theme-color));
    transform: translateY(30px);
    opacity: 0;
}

.cinematic-wrapper.theme-arcane.animate .cinematic-character {
    animation: arcane-char-rise var(--custom-duration, 3.5s) ease-out forwards 0.2s;
}

.cinematic-wrapper.theme-arcane.format-boxed.animate .cinematic-character {
    animation: arcane-char-rise var(--custom-duration, 3.5s) ease-out forwards 0.2s;
}

@keyframes arcane-char-rise {
    0% {
        transform: translateY(50px) rotate(var(--char-rotate)) scale(calc(0.95 * var(--char-mirror-x, 1)), 0.95);
        opacity: 0;
        filter: brightness(0) blur(5px);
    }

    20% {
        transform: translateY(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) drop-shadow(0 0 15px var(--theme-color)) brightness(1.1);
    }

    100% {
        transform: translateY(-20px) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 0;
        filter: var(--char-shadow-filter) drop-shadow(0 0 30px var(--theme-color)) blur(10px);
    }
}

/* ==========================================================================
   12. THEME: VOLTAGE (Speed / Electric)
   ========================================================================== */

.cinematic-wrapper.theme-voltage .cinematic-bg-layer,
.cinematic-wrapper.theme-voltage .cinematic-deco-line {
    position: absolute;
    top: var(--screen-y, 50%);
    left: -10%;
    width: 120%;
    height: 300px;
    box-sizing: border-box;
    transform-origin: center center;
    transform: translateY(-50%) skewX(-30deg) translateX(120%);
    opacity: 0;
}

.cinematic-wrapper.theme-voltage .cinematic-bg-layer {
    background: transparent;
    z-index: 2;
    border-top: 5px solid #fff;
    border-bottom: 5px solid #fff;
    box-shadow: 0 0 20px var(--theme-color), inset 0 0 20px var(--theme-color);
}

.cinematic-wrapper.theme-voltage .cinematic-paint {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    z-index: 1;
    transform: none;
    background-image: repeating-linear-gradient(90deg, transparent, transparent 50px, rgba(255, 255, 255, 0.1) 50px, rgba(255, 255, 255, 0.1) 52px);
    box-shadow: 0 0 50px rgba(0, 0, 0, 0.8);
}

.cinematic-wrapper.theme-voltage .cinematic-deco-line {
    pointer-events: none;
    z-index: 3;
    mix-blend-mode: screen;
    background: transparent;
}

.cinematic-wrapper.theme-voltage .cinematic-deco-line::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 20px;
    margin-top: -10px;
    background: #fff;
    box-shadow: 0 0 10px #fff, 0 0 20px var(--theme-color), 0 0 40px var(--theme-color);
    clip-path: polygon(0 40%, 15% 0, 30% 60%, 45% 20%, 60% 80%, 75% 30%, 100% 50%, 100% 60%, 75% 40%, 60% 90%, 45% 30%, 30% 70%, 15% 10%, 0 50%);
    transform: scaleX(0);
    opacity: 0;
}

.cinematic-wrapper.theme-voltage .cinematic-content {
    position: absolute;
    top: var(--screen-y, 50%);
    right: 10%;
    transform: translateY(-50%) skewX(-30deg);
    z-index: 10;
    text-align: right;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
}

.cinematic-wrapper.theme-voltage .cinematic-text-main {
    font-weight: 900;
    color: #fff;
    text-shadow: 4px 4px 0 var(--theme-color);
    transform: translateX(100px);
    opacity: 0;
}

.cinematic-wrapper.theme-voltage .cinematic-text-sub {
    background: var(--theme-color);
    color: #000;
    padding: 2px 10px;
    margin-top: 5px;
    font-weight: bold;
    text-transform: uppercase;
    transform: translateX(100px);
    opacity: 0;
    clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%);
}

/* Voltage 애니메이션 */
.cinematic-wrapper.theme-voltage.animate .cinematic-bg-layer,
.cinematic-wrapper.theme-voltage.animate .cinematic-paint,
.cinematic-wrapper.theme-voltage.animate .cinematic-deco-line {
    animation: voltage-group-rush var(--custom-duration, 3.5s) cubic-bezier(0.1, 0.9, 0.2, 1) forwards;
}

.cinematic-wrapper.theme-voltage.animate .cinematic-paint {
    animation: voltage-speed-lines 2s linear infinite;
}

.cinematic-wrapper.theme-voltage.animate .cinematic-deco-line::after {
    animation: voltage-flash 0.5s ease-out forwards 0.2s;
}

.cinematic-wrapper.theme-voltage.animate .cinematic-text-main {
    animation: voltage-text-hit var(--custom-duration, 3.5s) cubic-bezier(0.1, 0.9, 0.2, 1) forwards 0.1s;
}

.cinematic-wrapper.theme-voltage.animate .cinematic-text-sub {
    animation: voltage-text-hit var(--custom-duration, 3.5s) cubic-bezier(0.1, 0.9, 0.2, 1) forwards 0.2s;
}

@keyframes voltage-group-rush {
    0% {
        transform: translateY(-50%) skewX(-30deg) translateX(120%);
        opacity: 0;
    }

    10% {
        transform: translateY(-50%) skewX(-30deg) translateX(0%);
        opacity: 1;
    }

    90% {
        transform: translateY(-50%) skewX(-30deg) translateX(0%);
        opacity: 1;
    }

    100% {
        transform: translateY(-50%) skewX(-30deg) translateX(-120%);
        opacity: 0;
    }
}

@keyframes voltage-speed-lines {
    0% {
        background-position: 0 0;
    }

    100% {
        background-position: -500px 0;
    }
}

@keyframes voltage-flash {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    10% {
        transform: scaleX(1);
        opacity: 1;
    }

    50% {
        opacity: 1;
    }

    100% {
        transform: scaleX(1);
        opacity: 0;
    }
}

@keyframes voltage-text-hit {
    0% {
        transform: translateX(100px);
        opacity: 0;
    }

    10% {
        transform: translateX(0);
        opacity: 1;
    }

    90% {
        transform: translateX(0);
        opacity: 1;
    }

    100% {
        transform: translateX(-100px);
        opacity: 0;
    }
}

/* Voltage Formats */
.cinematic-wrapper.theme-voltage.format-popout .cinematic-character {
    bottom: calc(-5% - var(--char-offset-y, 0px));
    left: calc(0% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    transform: translateX(-100px);
    opacity: 0;
    filter: var(--char-shadow-filter) contrast(1.2);
}

.cinematic-wrapper.theme-voltage.format-boxed .char-mask {
    position: absolute;
    top: var(--screen-y, 50%);
    left: -10%;
    width: 120%;
    height: 300px;
    z-index: 5;
    transform: translateY(-50%) skewX(-30deg);
    overflow: hidden;
    clip-path: inset(5px 0 5px 0);
}

.cinematic-wrapper.theme-voltage.format-boxed .cinematic-character {
    position: absolute;
    top: calc(-10% + var(--char-offset-y, 0px));
    left: calc(15% - var(--char-offset-x, 0px));
    height: calc(140% * var(--char-scale, 1));
    width: auto;
    transform: skewX(30deg) translateX(-50px);
    opacity: 0;
    filter: var(--char-shadow-filter) contrast(1.2);
}

.cinematic-wrapper.theme-voltage.format-popout.animate .cinematic-character {
    animation: voltage-char-popout var(--custom-duration, 3.5s) cubic-bezier(0.1, 0.9, 0.2, 1) forwards 0.1s;
}

.cinematic-wrapper.theme-voltage.format-boxed.animate .cinematic-character {
    animation: voltage-char-boxed var(--custom-duration, 3.5s) cubic-bezier(0.1, 0.9, 0.2, 1) forwards 0.1s;
}

@keyframes voltage-char-popout {
    0% {
        transform: translateX(-200px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
    }

    10% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    100% {
        transform: translateX(200px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
    }
}

@keyframes voltage-char-boxed {

    /* 기존 Skew 30deg 유지 */
    0% {
        transform: skewX(30deg) translateX(-100px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
    }

    10% {
        transform: skewX(30deg) translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: skewX(30deg) translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    100% {
        transform: skewX(30deg) translateX(100px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
    }
}

/* ==========================================================================
   13. THEME: SCOPE (Minimal / Widescreen)
   ========================================================================== */

.cinematic-wrapper.theme-scope .cinematic-bg-layer {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    transform: none;
}

.cinematic-wrapper.theme-scope .cinematic-paint {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 180px;
    transform: translateY(-50%) scaleX(0);
    transform-origin: center;
    background: linear-gradient(90deg, transparent 0%, var(--theme-color) 20%, #fff 50%, var(--theme-color) 80%, transparent 100%);
    box-shadow: 0 0 30px var(--theme-color);
    opacity: 0.4;
    mix-blend-mode: screen;
}

.cinematic-wrapper.theme-scope .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 180px;
    transform: translateY(-50%);
    pointer-events: none;
    z-index: 2;
}

.cinematic-wrapper.theme-scope .cinematic-deco-line::after,
.cinematic-wrapper.theme-scope .cinematic-deco-line::before {
    content: "";
    position: absolute;
    left: 0;
    width: 100%;
    height: 1px;
    background: #fff;
    box-shadow: 0 0 5px #fff, 0 0 10px var(--theme-color), 0 0 20px var(--theme-color);
    transform: scaleX(0);
    transform-origin: center;
}

.cinematic-wrapper.theme-scope .cinematic-deco-line::after {
    top: 0;
}

.cinematic-wrapper.theme-scope .cinematic-deco-line::before {
    bottom: 0;
}

.cinematic-wrapper.theme-scope .cinematic-content {
    position: absolute;
    top: 50%;
    left: 15%;
    transform: translateY(-50%);
    z-index: 10;
    display: flex;
    flex-direction: column;
}

.cinematic-wrapper.theme-scope .cinematic-text-main {
    font-weight: 300;
    letter-spacing: 5px;
    text-shadow: 0 0 10px var(--theme-color);
    margin-left: var(--main-offset-x, 0px);
    margin-top: var(--main-offset-y, 0px);
    color: var(--main-text-color, #fff);
    transform: translateX(-50px);
    opacity: 0;
}

.cinematic-wrapper.theme-scope .cinematic-text-sub {
    font-weight: 700;
    text-transform: uppercase;
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    border-left: 3px solid var(--theme-color);
    padding: 2px 15px;
    margin-top: calc(5px + var(--sub-offset-y, 0px));
    margin-left: var(--sub-offset-x, 0px);
    color: var(--sub-text-color, #fff);
    transform: translateX(-50px);
    opacity: 0;
    backdrop-filter: blur(2px);
}

/* Scope 애니메이션 */
@keyframes scope-fade-in {
    0% {
        background: rgba(0, 0, 0, 0);
    }

    100% {
        background: rgba(0, 0, 0, 0.6);
    }
}

.cinematic-wrapper.theme-scope.animate .cinematic-paint {
    animation: scope-paint-expand var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-scope.animate .cinematic-deco-line::after,
.cinematic-wrapper.theme-scope.animate .cinematic-deco-line::before {
    animation: scope-line-expand var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-scope.animate .cinematic-character {
    animation: scope-char-slide var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0s;
}

.cinematic-wrapper.theme-scope.animate .cinematic-text-main {
    animation: scope-text-in var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-scope.animate .cinematic-text-sub {
    animation: scope-text-in var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.2s;
}

@keyframes scope-paint-expand {
    0% {
        transform: translateY(-50%) scaleX(0);
        opacity: 0;
    }

    5% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }

    90% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }

    100% {
        transform: translateY(-50%) scaleX(0);
        opacity: 0;
    }
}

@keyframes scope-line-expand {
    0% {
        transform: scaleX(0);
        opacity: 0;
    }

    5% {
        transform: scaleX(1);
        opacity: 1;
    }

    90% {
        transform: scaleX(1);
        opacity: 1;
    }

    100% {
        transform: scaleX(0);
        opacity: 0;
    }
}

@keyframes scope-char-slide {
    0% {
        transform: translateX(50px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
        filter: blur(5px);
    }

    10% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) blur(0);
    }

    90% {
        transform: translateX(-10px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) blur(0);
    }

    100% {
        transform: translateX(-20px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
        filter: blur(10px);
    }
}

@keyframes scope-text-in {
    0% {
        transform: translateX(-30px);
        opacity: 0;
    }

    10% {
        transform: translateX(0);
        opacity: 1;
    }

    90% {
        transform: translateX(0);
        opacity: 1;
    }

    100% {
        transform: translateX(10px);
        opacity: 0;
    }
}

/* Scope Formats */
.cinematic-wrapper.theme-scope.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    filter: var(--char-shadow-filter) contrast(1.2) brightness(1.1);
    transform: translateX(100px);
    opacity: 0;
}

.cinematic-wrapper.theme-scope.format-boxed .char-mask {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 180px;
    transform: translateY(-50%);
    clip-path: inset(2px 0 2px 0);
    overflow: hidden;
    z-index: 2;
}

.cinematic-wrapper.theme-scope.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(140% * var(--char-scale, 1));
    width: auto;
    transform: translateX(50px);
    opacity: 0;
}

/* ==========================================================================
   14. THEME: BLITZ (Fixed Positioning)
   ========================================================================== */

/* 공통 컨테이너 위치 */
.cinematic-wrapper.theme-blitz .cinematic-bg-layer,
.cinematic-wrapper.theme-blitz .cinematic-deco-line,
.cinematic-wrapper.theme-blitz .char-mask,
.cinematic-wrapper.theme-blitz .cinematic-content {
    position: absolute;
    top: var(--screen-y, 20%);
    left: var(--screen-x, 80%);
    width: 450px;
    height: 120px;
    z-index: 1;
}

.cinematic-wrapper.theme-blitz .cinematic-bg-layer {
    background: linear-gradient(90deg, transparent 0%, rgba(0, 0, 0, 0.8) 30%, rgba(0, 0, 0, 0.95) 100%);
    border-right: 5px solid var(--theme-color);
    border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    transform: translateX(50px) skewX(-20deg);
    opacity: 0;
    clip-path: polygon(10% 0, 100% 0, 100% 100%, 0% 100%);
}

.cinematic-wrapper.theme-blitz .cinematic-paint {
    position: absolute;
    inset: 0;
    opacity: 0.3;
    background-image: repeating-linear-gradient(-45deg, transparent, transparent 5px, var(--theme-color) 5px, var(--theme-color) 6px);
    mix-blend-mode: overlay;
}

.cinematic-wrapper.theme-blitz .cinematic-deco-line {
    pointer-events: none;
    z-index: 2;
    transform: translateX(50px) skewX(-20deg);
    opacity: 0;
}

.cinematic-wrapper.theme-blitz .cinematic-deco-line::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--theme-color);
    box-shadow: 0 0 10px var(--theme-color);
}

.cinematic-wrapper.theme-blitz .char-mask {
    z-index: 2;
    overflow: hidden;
    clip-path: polygon(10% 0, 100% 0, 100% 100%, 0% 100%);
    transform: translateX(50px) skewX(-20deg);
    opacity: 0;
}

.cinematic-wrapper.theme-blitz .cinematic-character {
    position: absolute;
    top: -15%;
    right: -10%;
    transform: translate(calc(var(--char-offset-x, 0px) * -1), var(--char-offset-y, 0px)) skewX(20deg) scale(var(--char-scale, 1.0));
    width: 120%;
    height: auto;
    filter: drop-shadow(5px 5px 5px rgba(0, 0, 0, 0.5));
    opacity: 1;
}

.cinematic-wrapper.theme-blitz .cinematic-content {
    z-index: 10;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    padding-left: 60px;
    transform: translateX(50px);
    opacity: 0;
}

.cinematic-wrapper.theme-blitz .cinematic-text-main {
    font-weight: 900;
    font-style: italic;
    font-size: 2.5rem !important;
    color: #fff;
    text-transform: uppercase;
    text-shadow: 2px 2px 0 #000;
    margin: 0;
    line-height: 1;
}

.cinematic-wrapper.theme-blitz .cinematic-text-sub {
    font-size: 1rem !important;
    color: var(--sub-text-color, #fff);
    background: rgba(0, 0, 0, 0.5);
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: bold;
    position: relative;
    left: var(--sub-offset-x, 0px);
    margin-top: calc(5px + var(--sub-offset-y, 0px));
    opacity: 1;
    transform: none;
}

/* Blitz 애니메이션 */
.cinematic-wrapper.theme-blitz.animate .cinematic-bg-layer,
.cinematic-wrapper.theme-blitz.animate .cinematic-deco-line,
.cinematic-wrapper.theme-blitz.animate .char-mask,
.cinematic-wrapper.theme-blitz.animate .cinematic-content {
    animation: hsr-slide-in 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-blitz.animate .cinematic-character {
    animation: hsr-char-move var(--custom-duration, 2.5s) ease-out forwards;
}

@keyframes hsr-slide-in {
    0% {
        transform: translateX(100px) skewX(-20deg);
        opacity: 0;
    }

    100% {
        transform: translateX(0px) skewX(-20deg);
        opacity: 1;
    }
}

@keyframes hsr-char-move {
    0% {
        transform: translate(calc(var(--char-offset-x, 0px) * -1 + 20px), var(--char-offset-y, 0px)) skewX(20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.0) * var(--char-mirror-x, 1)), var(--char-scale, 1.0));
    }

    100% {
        transform: translate(calc(var(--char-offset-x, 0px) * -1), var(--char-offset-y, 0px)) skewX(20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.0) * var(--char-mirror-x, 1)), var(--char-scale, 1.0));
    }
}

/* ==========================================================================
   15. THEME: BLITZ LEFT (Fixed Positioning - Left Side)
   ========================================================================== */

.cinematic-wrapper.theme-blitz_left .cinematic-bg-layer,
.cinematic-wrapper.theme-blitz_left .cinematic-deco-line,
.cinematic-wrapper.theme-blitz_left .char-mask,
.cinematic-wrapper.theme-blitz_left .cinematic-content {
    position: absolute;
    top: var(--screen-y, 20%);
    left: var(--screen-x, 20%);
    margin-left: -100px;
    width: 450px;
    height: 120px;
    z-index: 1;
    transform: translateX(-120%) skewX(20deg);
    opacity: 0;
}

.cinematic-wrapper.theme-blitz_left .cinematic-bg-layer {
    background: linear-gradient(-90deg, transparent 0%, rgba(0, 0, 0, 0.8) 30%, rgba(0, 0, 0, 0.95) 100%);
    border-left: 5px solid var(--theme-color);
    border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    transform: translateX(-50px) skewX(20deg);
    opacity: 0;
    clip-path: polygon(0% 0%, 90% 0%, 100% 100%, 0% 100%);
}

.cinematic-wrapper.theme-blitz_left .cinematic-paint {
    position: absolute;
    inset: 0;
    opacity: 0.3;
    background-image: repeating-linear-gradient(45deg, transparent, transparent 5px, var(--theme-color) 5px, var(--theme-color) 6px);
    mix-blend-mode: overlay;
}

.cinematic-wrapper.theme-blitz_left .cinematic-deco-line {
    pointer-events: none;
    z-index: 2;
    transform: translateX(-50px) skewX(20deg);
    opacity: 0;
}

.cinematic-wrapper.theme-blitz_left .cinematic-deco-line::after {
    content: "";
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100%;
    height: 2px;
    background: var(--theme-color);
    box-shadow: 0 0 10px var(--theme-color);
}

.cinematic-wrapper.theme-blitz_left .char-mask {
    z-index: 2;
    overflow: hidden;
    clip-path: polygon(0% 0%, 90% 0%, 100% 100%, 0% 100%);
    transform: translateX(-50px) skewX(20deg);
    opacity: 0;
}

.cinematic-wrapper.theme-blitz_left .cinematic-character {
    position: absolute;
    top: -15%;
    left: -10%;
    width: 120%;
    height: auto;
    transform: translate(calc(var(--char-offset-x, 0px)), var(--char-offset-y, 0px)) skewX(-20deg) scale(var(--char-scale, 1.0));
    filter: drop-shadow(5px 5px 5px rgba(0, 0, 0, 0.5));
    opacity: 1;
}

.cinematic-wrapper.theme-blitz_left .cinematic-content {
    z-index: 10;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-end;
    padding-right: 60px;
    transform: translateX(-50px);
    opacity: 0;
}

.cinematic-wrapper.theme-blitz_left .cinematic-text-main {
    font-weight: 900;
    font-style: italic;
    font-size: 2.5rem !important;
    color: #fff;
    text-transform: uppercase;
    text-shadow: 2px 2px 0 #000;
    margin: 0;
    line-height: 1;
    text-align: right;
}

.cinematic-wrapper.theme-blitz_left .cinematic-text-sub {
    font-size: 1rem !important;
    color: var(--sub-text-color, #fff);
    background: rgba(0, 0, 0, 0.5);
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: bold;
    position: relative;
    left: var(--sub-offset-x, 0px);
    margin-top: calc(5px + var(--sub-offset-y, 0px));
    opacity: 1;
    transform: none;
}

/* Blitz Left 애니메이션 */
.cinematic-wrapper.theme-blitz_left.animate .cinematic-bg-layer,
.cinematic-wrapper.theme-blitz_left.animate .cinematic-deco-line,
.cinematic-wrapper.theme-blitz_left.animate .char-mask,
.cinematic-wrapper.theme-blitz_left.animate .cinematic-content {
    animation: hsr-slide-in-left 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-blitz_left.animate .cinematic-character {
    animation: hsr-char-move-left var(--custom-duration, 2.5s) ease-out forwards;
}

@keyframes hsr-slide-in-left {
    0% {
        transform: translateX(-100px) skewX(20deg);
        opacity: 0;
    }

    100% {
        transform: translateX(0px) skewX(20deg);
        opacity: 1;
    }
}

@keyframes hsr-char-move-left {

    /* Skew -20deg + 사용자 회전/반전 */
    0% {
        transform: translate(calc(var(--char-offset-x, 0px) - 20px), var(--char-offset-y, 0px)) skewX(-20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.0) * var(--char-mirror-x, 1)), var(--char-scale, 1.0));
    }

    100% {
        transform: translate(calc(var(--char-offset-x, 0px)), var(--char-offset-y, 0px)) skewX(-20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.0) * var(--char-mirror-x, 1)), var(--char-scale, 1.0));
    }
}

/* ==========================================================================
   16. THEME: BLOSSOM (Soft / Elegant / Flowery)
   ========================================================================== */

.cinematic-wrapper.theme-blossom .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%);
    z-index: 1;
    /* 부드러운 가장자리 흐림 효과 */
    filter: drop-shadow(0 0 20px rgba(255, 183, 178, 0.6));
}

.cinematic-wrapper.theme-blossom .cinematic-paint {
    position: absolute;
    top: 10%;
    left: -5%;
    width: 110%;
    height: 80%;
    /* 벚꽃 그라데이션 */
    background: linear-gradient(90deg, transparent 0%, var(--theme-color, #ffb7b2) 20%, #ff9e99 50%, var(--theme-color, #ffb7b2) 80%, transparent 100%);

    /* 둥근 곡선 모양 */
    border-radius: 50% / 20%;

    /* 패턴이 둥근 모서리 밖으로 나가지 않도록 잘라냄 */
    overflow: hidden;

    opacity: 0.8;
    transform: scaleX(0);
    transform-origin: center;
}

.cinematic-wrapper.theme-blossom .cinematic-paint::before {
    /* 꽃잎 텍스처 패턴 */
    content: "";
    position: absolute;
    inset: 0;
    background-image: radial-gradient(#fff 20%, transparent 20%), radial-gradient(#fff 20%, transparent 20%);
    background-color: transparent;
    background-position: 0 0, 50px 50px;
    background-size: 100px 100px;
    opacity: 0.3;
    mix-blend-mode: overlay;

    /* 양쪽 끝 자연스럽게 지우기 */
    mask-image: linear-gradient(90deg, transparent, #000 20%, #000 80%, transparent);
    -webkit-mask-image: linear-gradient(90deg, transparent, #000 20%, #000 80%, transparent);
}

.cinematic-wrapper.theme-blossom .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%);
    pointer-events: none;
    z-index: 2;
}

/* 흩날리는 꽃잎 효과 */
.cinematic-wrapper.theme-blossom .cinematic-deco-line::after,
.cinematic-wrapper.theme-blossom .cinematic-deco-line::before {
    content: "❀";
    position: absolute;
    font-size: 4rem;
    color: #fff;
    text-shadow: 0 0 10px #ff6b6b;
    opacity: 0;
}

.cinematic-wrapper.theme-blossom .cinematic-deco-line::after {
    top: 20%;
    left: 20%;
}

.cinematic-wrapper.theme-blossom .cinematic-deco-line::before {
    bottom: 20%;
    right: 20%;
    font-size: 3rem;
}

.cinematic-wrapper.theme-blossom .cinematic-content {
    position: absolute;
    top: 50%;
    right: 15%;
    transform: translateY(-50%);
    z-index: 10;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    text-align: right;
}

.cinematic-wrapper.theme-blossom .cinematic-text-main {
    font-family: serif;
    font-style: italic;
    font-weight: 500;
    color: var(--main-text-color, #fff);
    text-shadow: 0 0 10px var(--theme-color, #ffb7b2);
    margin: 0;
    line-height: 1;
    transform: translateX(30px);
    opacity: 0;
}

.cinematic-wrapper.theme-blossom .cinematic-text-sub {
    font-family: serif;
    font-size: 1.5rem;
    color: var(--sub-text-color, #fff);
    border-bottom: 1px solid #fff;
    padding-bottom: 5px;
    margin-top: 10px;
    transform: translateX(30px);
    opacity: 0;
}

/* --------------------------------------------------------
    BLOSSOM ANIMATIONS
   -------------------------------------------------------- */

/* 배경: 등장 시 펼쳐짐 -> 유지 -> 퇴장 시 살짝 커지며 흐려짐 (Dissolve) */
.cinematic-wrapper.theme-blossom.animate .cinematic-paint {
    animation: blossom-bg-dissolve var(--custom-duration, 4s) ease-in-out forwards;
}

@keyframes blossom-bg-dissolve {
    0% {
        transform: scaleX(0);
        opacity: 0;
        filter: blur(0px);
    }

    15% {
        transform: scaleX(1);
        opacity: 0.9;
        filter: blur(0px);
    }

    90% {
        transform: scaleX(1) scaleY(1);
        opacity: 0.9;
        filter: blur(0px);
    }

    /* 퇴장: 크기가 살짝 커지면서(scaleY) 안개처럼 흐려짐 */
    100% {
        transform: scaleX(1.05) scaleY(1.2);
        opacity: 0;
        filter: blur(4px);
    }
}

/* 꽃잎 애니메이션 */
.cinematic-wrapper.theme-blossom.animate .cinematic-deco-line::after {
    animation: blossom-petal-float var(--custom-duration, 4s) ease-out forwards 0.5s;
}

.cinematic-wrapper.theme-blossom.animate .cinematic-deco-line::before {
    animation: blossom-petal-float-rev var(--custom-duration, 4s) ease-out forwards 0.7s;
}

@keyframes blossom-petal-float {
    0% {
        opacity: 0;
        transform: translate(0, 0) rotate(0deg);
    }

    20% {
        opacity: 0.8;
    }

    80% {
        opacity: 0.8;
    }

    100% {
        opacity: 0;
        transform: translate(100px, -50px) rotate(90deg);
    }
}

@keyframes blossom-petal-float-rev {
    0% {
        opacity: 0;
        transform: translate(0, 0) rotate(0deg);
    }

    20% {
        opacity: 0.6;
    }

    80% {
        opacity: 0.6;
    }

    100% {
        opacity: 0;
        transform: translate(-100px, 50px) rotate(-90deg);
    }
}

/* 텍스트: 등장 후 유지하다가 부드럽게 흐려짐 */
.cinematic-wrapper.theme-blossom.animate .cinematic-text-main {
    animation: blossom-text-dissolve var(--custom-duration, 4s) ease-out forwards 0.2s;
}

.cinematic-wrapper.theme-blossom.animate .cinematic-text-sub {
    animation: blossom-text-dissolve var(--custom-duration, 4s) ease-out forwards 0.4s;
}

@keyframes blossom-text-dissolve {
    0% {
        opacity: 0;
        transform: translateX(30px);
        filter: blur(5px);
    }

    10% {
        opacity: 1;
        transform: translateX(0);
        filter: blur(0);
    }

    90% {
        opacity: 1;
        transform: translateX(0);
        filter: blur(0);
    }

    /* 퇴장: 약간 이동하며 약한 블러 */
    100% {
        opacity: 0;
        transform: translateX(-10px);
        filter: blur(2px);
    }
}

/* 캐릭터: 배경과 타이밍을 맞추고 과한 블러 제거 */
.cinematic-wrapper.theme-blossom.animate .cinematic-character {
    animation: blossom-char-slide var(--custom-duration, 4s) ease-out forwards 0.2s;
}

@keyframes blossom-char-slide {
    0% {
        transform: translateX(-50px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
        filter: blur(5px);
    }

    15% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5)) blur(0);
    }

    90% {
        transform: translateX(10px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5)) blur(0);
    }

    100% {
        transform: translateX(20px) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 0;
        filter: blur(2px);
    }
}

/* Blossom Formats */
.cinematic-wrapper.theme-blossom.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    left: calc(10% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
    filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5)) contrast(1.1);
    transform: translateX(-50px);
    opacity: 0;
}

.cinematic-wrapper.theme-blossom.format-boxed .char-mask {
    /* 배경(.cinematic-bg-layer)과 동일한 높이/위치 기준 */
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%);
    z-index: 2;

    /* Paint(80% 높이) 안에 캐릭터가 들어가도록 마스크 크기 축소 */
    /* Paint가 height: 80%이므로, 마스크도 위아래를 10%씩 잘라내야 함 */
    /* 가로폭도 Paint가 넓으므로, 타원을 가로로 길게 설정 */
    clip-path: ellipse(55% 40% at 50% 50%);
    overflow: hidden;
}

.cinematic-wrapper.theme-blossom.format-boxed .cinematic-character {
    /* 캐릭터 위치 미세 조정 */
    top: calc(0% + var(--char-offset-y, 0px));
    left: calc(10% - var(--char-offset-x, 0px));
    height: calc(120% * var(--char-scale, 1));
    width: auto;
    transform: translateX(-30px);
    opacity: 0;
}

/* ==========================================================================
   17. THEME: SLASH (Stylish / Diagonal Split)
   ========================================================================== */

/* 
   [그룹 1] 최상위 형제 요소들 (Siblings)
   이들은 화면에 직접 배치되므로 좌표와 기울기를 지정해야 합니다.
    주의: .cinematic-paint는 여기서 뺍니다! (자식이라서)
*/
.cinematic-wrapper.theme-slash .cinematic-bg-layer,
.cinematic-wrapper.theme-slash .cinematic-deco-line,
.cinematic-wrapper.theme-slash .char-mask,
.cinematic-wrapper.theme-slash .cinematic-pattern-overlay,
.cinematic-wrapper.theme-slash .cinematic-content {
    position: absolute !important;
    inset: auto !important;

    /* 화면 전체 높이 */
    top: 0 !important;
    bottom: 0 !important;
    height: 100% !important;

    /* X축 위치 */
    left: var(--screen-x, 50%) !important;

    /* 크기 500px 고정 */
    width: 500px !important;
    margin: 0 !important;
    margin-left: -250px !important;
    /* 중앙 정렬 */

    /* 기울기 적용 */
    transform: skewX(-20deg);
    transform-origin: 50% 50% !important;

    z-index: 1;
    box-sizing: border-box !important;
}

/* --------------------------------------------------------
   개별 레이어 스타일링
   -------------------------------------------------------- */

/* 1. 배경 (부모) */
.cinematic-wrapper.theme-slash .cinematic-bg-layer {
    z-index: 1;
    background: #000;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.9);

    /* 애니메이션용 초기 상태 */
    transform: skewX(-20deg) scaleX(0);
    border: none !important;
}

/* 2. 내부 패턴 (자식) */
/* 부모(bg-layer) 안에 살고 있으므로, 별도의 위치/기울기 지정 금지! */
.cinematic-wrapper.theme-slash .cinematic-paint {
    display: block !important;
    z-index: 10;

    /* 부모를 가득 채움 */
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 !important;
    inset: 0 !important;

    /*  중요: 변형(skew/scale) 제거! 부모가 변하면 같이 변함 */
    transform: none !important;

    /* 스타일 */
    background-image: repeating-linear-gradient(90deg, transparent, transparent 10px, rgba(255, 255, 255, 0.1) 10px, rgba(255, 255, 255, 0.1) 12px);
    mix-blend-mode: screen;
    pointer-events: none;
    clip-path: none !important;
}

/* 3. 캐릭터 마스크 (형제) */
.cinematic-wrapper.theme-slash .char-mask {
    z-index: 5;
    overflow: hidden !important;
    /* 마스크는 항상 열려있고 내부 Clip으로 제어 */
    transform: skewX(-20deg) scaleX(1) !important;
    clip-path: inset(0 50% 0 50%);
    pointer-events: none;
}

/* 캐릭터 본체 */
.cinematic-wrapper.theme-slash .cinematic-character {
    position: absolute !important;
    width: 100% !important;
    height: 100% !important;
    top: 0;
    left: 0;
    margin: 0 !important;
    object-position: center bottom;

    /* 부모 기울기 상쇄 (+20도) */
    transform: translate(var(--char-offset-x, 0px), var(--char-offset-y, 0px)) skewX(20deg) scale(var(--char-scale, 1.2));
    transform-origin: 50% 100%;

    opacity: 0;
    filter: contrast(1.3) drop-shadow(10px 10px 0 rgba(0, 0, 0, 0.5));
}

/* 4. 테두리 (형제) */
.cinematic-wrapper.theme-slash .cinematic-deco-line {
    z-index: 15;
    pointer-events: none;
    overflow: visible;
    mix-blend-mode: normal;
    background: transparent;

    border-left: 5px solid var(--theme-color, #fff);
    border-right: 5px solid var(--theme-color, #fff);

    /* 배경과 동일하게 움직임 */
    transform: skewX(-20deg) scaleX(0);
}

/* 빛나는 선 */
.cinematic-wrapper.theme-slash .cinematic-deco-line::after,
.cinematic-wrapper.theme-slash .cinematic-deco-line::before {
    content: "";
    position: absolute;
    width: 3px;
    height: 120%;
    top: -10%;
    background: #fff;
    box-shadow: 0 0 15px var(--theme-color, #fff);
    opacity: 0;
}

.cinematic-wrapper.theme-slash .cinematic-deco-line::after {
    left: -3px;
}

.cinematic-wrapper.theme-slash .cinematic-deco-line::before {
    right: -3px;
}

/* 5. 텍스트 (형제) */
.cinematic-wrapper.theme-slash .cinematic-content {
    z-index: 20;
    /* 텍스트 컨테이너는 Scale 안함 -> Skew만 */
    transform: skewX(-20deg) scaleX(1) !important;

    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: flex-end;
    padding-bottom: 15% !important;
    padding-right: 20px !important;
    pointer-events: none;
}

.cinematic-wrapper.theme-slash .cinematic-text-main {
    transform: skewX(20deg) translateX(50px);
    font-weight: 900;
    font-style: italic;
    text-transform: uppercase;
    color: var(--main-text-color, #fff);
    text-shadow: 5px 5px 0 var(--theme-color);
    opacity: 0;
    margin: 0;
    line-height: 0.9;
}

.cinematic-wrapper.theme-slash .cinematic-text-sub {
    transform: skewX(20deg) translateX(50px);
    background: var(--theme-color);
    color: #000;
    font-weight: bold;
    padding: 2px 10px;
    margin-top: 10px;
    box-shadow: 5px 5px 0 #000;
    opacity: 0;
}

/* --------------------------------------------------------
   SLASH ANIMATIONS
   -------------------------------------------------------- */

/* 1. Scale 그룹: 배경, 테두리 */
/*  .cinematic-paint는 자식이므로 애니메이션 안 줘도 부모(bg-layer) 따라 움직임 */
.cinematic-wrapper.theme-slash.animate .cinematic-bg-layer,
.cinematic-wrapper.theme-slash.animate .cinematic-deco-line {
    animation: slash-open-scale var(--custom-duration, 4s) cubic-bezier(0.19, 1, 0.22, 1) forwards;
}

/* 2. Clip 그룹: 캐릭터 */
.cinematic-wrapper.theme-slash.animate .char-mask {
    animation: slash-open-clip var(--custom-duration, 4s) cubic-bezier(0.19, 1, 0.22, 1) forwards;
}

/* 기타 애니메이션 */
.cinematic-wrapper.theme-slash.animate .cinematic-deco-line::after,
.cinematic-wrapper.theme-slash.animate .cinematic-deco-line::before {
    animation: slash-gleam 0.5s ease-out forwards;
}

.cinematic-wrapper.theme-slash.animate .cinematic-character {
    animation: slash-char-appear var(--custom-duration, 4s) cubic-bezier(0.19, 1, 0.22, 1) forwards 0.1s;
}

.cinematic-wrapper.theme-slash.animate .cinematic-text-main,
.cinematic-wrapper.theme-slash.animate .cinematic-text-sub {
    animation: slash-text-in 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.3s;
}

/* --- KEYFRAMES --- */

@keyframes slash-open-scale {
    0% {
        transform: skewX(-20deg) scaleX(0);
    }

    15% {
        transform: skewX(-20deg) scaleX(1);
    }

    90% {
        transform: skewX(-20deg) scaleX(1);
    }

    100% {
        transform: skewX(-20deg) scaleX(0);
    }
}

@keyframes slash-open-clip {
    0% {
        clip-path: inset(0 50% 0 50%);
        opacity: 1;
    }

    15% {
        clip-path: inset(0 0 0 0);
        opacity: 1;
    }

    90% {
        clip-path: inset(0 0 0 0);
        opacity: 1;
    }

    100% {
        clip-path: inset(0 50% 0 50%);
        opacity: 0;
    }
}

@keyframes slash-gleam {
    0% {
        height: 0;
        opacity: 0;
    }

    50% {
        height: 120%;
        opacity: 1;
    }

    100% {
        height: 120%;
        opacity: 0;
    }
}

@keyframes slash-char-appear {
    0% {
        opacity: 0;
        transform: translate(var(--char-offset-x, 0px), var(--char-offset-y, 0px)) skewX(20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.2) * 1.1 * var(--char-mirror-x, 1)), calc(var(--char-scale, 1.2) * 1.1));
    }

    15% {
        opacity: 1;
        transform: translate(var(--char-offset-x, 0px), var(--char-offset-y, 0px)) skewX(20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.2) * var(--char-mirror-x, 1)), var(--char-scale, 1.2));
    }

    90% {
        opacity: 1;
        transform: translate(var(--char-offset-x, 0px), var(--char-offset-y, 0px)) skewX(20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.2) * var(--char-mirror-x, 1)), var(--char-scale, 1.2));
    }

    100% {
        opacity: 0;
        transform: translate(var(--char-offset-x, 0px), var(--char-offset-y, 0px)) skewX(20deg) rotate(var(--char-rotate)) scale(calc(var(--char-scale, 1.2) * 1.1 * var(--char-mirror-x, 1)), calc(var(--char-scale, 1.2) * 1.1));
    }
}

@keyframes slash-text-in {
    0% {
        opacity: 0;
        transform: skewX(20deg) translateX(50px);
    }

    100% {
        opacity: 1;
        transform: skewX(20deg) translateX(0);
    }
}

/* ==========================================================================
   18. THEME: Burst (Personal Theme)
   ========================================================================== */

/* 위치: 화면 정중앙 고정 */
.cinematic-wrapper.theme-burst .cinematic-bg-layer,
.cinematic-wrapper.theme-burst .cinematic-deco-line,
.cinematic-wrapper.theme-burst .cinematic-content {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 220px;
    transform: translateY(-50%);
}

/* 1. 배경: 그라데이션 스트립 */
.cinematic-wrapper.theme-burst .cinematic-bg-layer {
    background: linear-gradient(90deg,
            rgba(0, 0, 0, 0) 0%,
            rgba(0, 0, 0, 0.8) 20%,
            rgba(0, 0, 0, 0.95) 50%,
            rgba(0, 0, 0, 0.8) 80%,
            rgba(0, 0, 0, 0) 100%);
    border-top: 2px solid rgba(255, 255, 255, 0.1);
    border-bottom: 2px solid rgba(255, 255, 255, 0.1);
    transform: translateY(-50%) scaleX(0);
    z-index: 1;
}

/* 2. 내부 패턴 */
.cinematic-wrapper.theme-burst .cinematic-paint {
    position: absolute;
    inset: 0;
    background-image: repeating-linear-gradient(-45deg,
            transparent,
            transparent 10px,
            var(--theme-color, #00ffcc) 10px,
            var(--theme-color, #00ffcc) 11px);
    opacity: 0.2;
    mix-blend-mode: add;
    transform: none;
}

/* 3. 장식 선: 닫히는 괄호 효과 */
.cinematic-wrapper.theme-burst .cinematic-deco-line {
    pointer-events: none;
    z-index: 2;
    overflow: visible;
}

.cinematic-wrapper.theme-burst .cinematic-deco-line::after,
.cinematic-wrapper.theme-burst .cinematic-deco-line::before {
    content: "";
    position: absolute;
    top: 0;
    width: 50px;
    height: 100%;
    border-top: 4px solid var(--theme-color);
    border-bottom: 4px solid var(--theme-color);
    box-shadow: 0 0 15px var(--theme-color);
    opacity: 0;
}

.cinematic-wrapper.theme-burst .cinematic-deco-line::after {
    left: 20%;
    border-left: 4px solid var(--theme-color);
    transform: translateX(-100px);
}

.cinematic-wrapper.theme-burst .cinematic-deco-line::before {
    right: 20%;
    border-right: 4px solid var(--theme-color);
    transform: translateX(100px);
}

/* 4. 텍스트 */
.cinematic-wrapper.theme-burst .cinematic-content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;
    text-align: center;
}

/* 폰트와 색상 변수 적용 */
.cinematic-wrapper.theme-burst .cinematic-text-main {
    font-family: var(--cinematic-font, 'Teko'), sans-serif;
    /* 변수 적용 */
    font-weight: 900;
    font-style: italic;
    color: var(--main-text-color, #fff);
    /* 변수 적용 */
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 2px 2px 0 #000, 0 0 20px var(--theme-color);
    transform: scale(2);
    opacity: 0;
    margin: 0;
}

/* 폰트와 색상 변수 적용 */
.cinematic-wrapper.theme-burst .cinematic-text-sub {
    font-family: var(--cinematic-font, 'Teko'), monospace;
    /* 변수 적용 */
    font-size: 1.2rem;
    font-weight: bold;
    background: var(--theme-color);
    color: var(--sub-text-color, #000);
    /* 변수 적용 */
    padding: 2px 15px;
    margin-top: 5px;
    clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%);
    transform: translateY(20px);
    opacity: 0;
}

/* --- ANIMATIONS (custom-duration 적용) --- */
.cinematic-wrapper.theme-burst.animate .cinematic-bg-layer {
    animation: skill-bg-expand var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-burst.animate .cinematic-paint {
    animation: skill-pattern-flow 2s linear infinite;
}

.cinematic-wrapper.theme-burst.animate .cinematic-deco-line::after,
.cinematic-wrapper.theme-burst.animate .cinematic-deco-line::before {
    animation: skill-bracket-close 0.5s cubic-bezier(0.1, 0.9, 0.2, 1) forwards;
}

.cinematic-wrapper.theme-burst.animate .cinematic-deco-line {
    animation: skill-deco-fadeout var(--custom-duration, 3.5s) steps(1, end) forwards;
}

.cinematic-wrapper.theme-burst.animate .cinematic-text-main {
    animation: skill-text-hit var(--custom-duration, 3.5s) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 0.1s;
}

.cinematic-wrapper.theme-burst.animate .cinematic-text-sub {
    animation: skill-sub-rise var(--custom-duration, 3.5s) ease-out forwards 0.2s;
}

.cinematic-wrapper.theme-burst.format-popout.animate .cinematic-character {
    animation: skill-char-popout var(--custom-duration, 3.5s) cubic-bezier(0.19, 1, 0.22, 1) forwards 0.1s;
}

.cinematic-wrapper.theme-burst.format-boxed.animate .cinematic-character {
    animation: skill-char-boxed var(--custom-duration, 3.5s) cubic-bezier(0.19, 1, 0.22, 1) forwards 0.1s;
}

/* Keyframes */
@keyframes skill-bg-expand {
    0% {
        transform: translateY(-50%) scaleX(0);
        opacity: 0;
    }

    10% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }

    90% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }

    100% {
        transform: translateY(-50%) scaleX(0);
        opacity: 0;
    }
}

@keyframes skill-pattern-flow {
    0% {
        background-position: 0 0;
    }

    100% {
        background-position: 100px 0;
    }
}

@keyframes skill-bracket-close {
    0% {
        transform: translateX(var(--start-x, -200px));
        opacity: 0;
    }

    100% {
        transform: translateX(0);
        opacity: 1;
    }
}

.cinematic-wrapper.theme-burst.animate .cinematic-deco-line::after {
    --start-x: -200px;
}

.cinematic-wrapper.theme-burst.animate .cinematic-deco-line::before {
    --start-x: 200px;
}

@keyframes skill-deco-fadeout {
    0% {
        opacity: 1;
    }

    90% {
        opacity: 1;
    }

    100% {
        opacity: 0;
    }
}

@keyframes skill-text-hit {
    0% {
        transform: scale(3);
        opacity: 0;
        filter: blur(10px);
    }

    10% {
        transform: scale(1);
        opacity: 1;
        filter: blur(0);
    }

    90% {
        transform: scale(1);
        opacity: 1;
        filter: blur(0);
    }

    100% {
        transform: scale(3);
        opacity: 0;
        filter: blur(10px);
    }
}

@keyframes skill-sub-rise {
    0% {
        transform: translateY(20px);
        opacity: 0;
    }

    10% {
        transform: translateY(0);
        opacity: 1;
    }

    90% {
        transform: translateY(0);
        opacity: 1;
    }

    100% {
        transform: translateY(20px);
        opacity: 0;
    }
}

@keyframes skill-char-popout {
    0% {
        transform: translateY(100%) rotate(var(--char-rotate)) scale(calc(0.8 * var(--char-mirror-x, 1)), 0.8);
        opacity: 0;
    }

    15% {
        transform: translateY(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: translateY(0) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
    }

    100% {
        transform: translateY(10%) rotate(var(--char-rotate)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
    }
}

@keyframes skill-char-boxed {
    0% {
        transform: translateX(-50px) rotate(var(--char-rotate)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
    }

    15% {
        transform: translateX(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    90% {
        transform: translateX(20px) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
    }

    100% {
        transform: translateX(40px) rotate(var(--char-rotate)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
    }
}

/* Formats & Overrides */

/* Popout Mode: 중앙 하단에서 솟구침 */
.cinematic-wrapper.theme-burst.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 5;
    overflow: visible;
}

.cinematic-wrapper.theme-burst.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    left: 50%;
    margin-left: calc(-25vh - var(--char-offset-x, 0px));
    height: calc(120% * var(--char-scale, 1));
    width: auto;
    filter: var(--char-shadow-filter) contrast(1.1);
    transform: translateY(100%);
    opacity: 0;
}

/* Boxed Mode: 박스 내부에서 슬라이드 */
.cinematic-wrapper.theme-burst.format-boxed .char-mask {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 220px;
    transform: translateY(-50%);
    z-index: 3;
    clip-path: inset(0 0 2px 0);
    overflow: hidden;
}

.cinematic-wrapper.theme-burst.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    left: 20%;
    margin-left: var(--char-offset-x, 0px);
    height: calc(140% * var(--char-scale, 1));
    width: auto;
    filter: var(--char-shadow-filter) contrast(1.1);
    transform: translateX(-50px);
    opacity: 0;
}

/* ==========================================================================
   19. THEME: GLITCH (Variables Fixed + Hard Noise BG)
   ========================================================================== */

/* 1. 배경: 어두운 노이즈 + 보더 설정 적용 */
.cinematic-wrapper.theme-glitch .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%);
    z-index: 1;
    background: #050505;

    /*   설정창의 보더 두께와 색상 변수 적용 */
    border-top: var(--border-width, 2px) solid var(--border-color, var(--theme-color));
    border-bottom: var(--border-width, 2px) solid var(--border-color, var(--theme-color));

    /* 기본 모양 */
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
}

.cinematic-wrapper.theme-glitch .cinematic-paint {
    position: absolute;
    inset: 0;
    opacity: 0.5;
    background-image: repeating-linear-gradient(0deg, transparent, transparent 2px, #000 2px, #000 4px);
    background-size: 100% 4px;
}

/* 2. 장식선 */
.cinematic-wrapper.theme-glitch .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%);
    pointer-events: none;
    z-index: 5;
}

.cinematic-wrapper.theme-glitch .cinematic-deco-line::after,
.cinematic-wrapper.theme-glitch .cinematic-deco-line::before {
    content: "";
    position: absolute;
    left: 0;
    width: 100%;
    height: 1px;
    background: var(--theme-color);
    opacity: 0;
}

/* 3. 텍스트: 폰트 및 색상 변수 적용 */
.cinematic-wrapper.theme-glitch .cinematic-content {
    position: absolute;
    top: 50%;
    left: 5%;
    transform: translateY(-50%);
    z-index: 10;
    display: flex;
    flex-direction: column;
}

.cinematic-wrapper.theme-glitch .cinematic-text-main {
    /*   설정창 폰트 적용 (없으면 monospace) */
    font-family: var(--cinematic-font), monospace;
    font-weight: bold;
    letter-spacing: -2px;

    /*   메인 텍스트 색상 적용 */
    color: var(--main-text-color, #fff);

    /* RGB 쉐도우 */
    text-shadow: 3px 0 red, -3px 0 blue;
    opacity: 0;
    transform: translateX(-20px);
}

.cinematic-wrapper.theme-glitch .cinematic-text-sub {
    /*   설정창 폰트 적용 */
    font-family: var(--cinematic-font), monospace;

    background: #000;
    border: 1px solid var(--theme-color);

    /*   서브 텍스트 색상 적용 */
    color: var(--sub-text-color, #fff);

    padding: 2px 10px;
    margin-top: 5px;
    opacity: 0;
    box-shadow: 4px 4px 0 var(--theme-color);
}

/* --- ANIMATIONS --- */

/* 배경: 더 복잡하게 깨지는 애니메이션 */
.cinematic-wrapper.theme-glitch.animate .cinematic-bg-layer {
    animation: glitch-bg-hard-break var(--custom-duration) steps(2, start) infinite;
}

.cinematic-wrapper.theme-glitch.animate .cinematic-deco-line::after {
    animation: glitch-line-anim 0.2s steps(2, start) infinite;
    top: 10%;
}

.cinematic-wrapper.theme-glitch.animate .cinematic-deco-line::before {
    animation: glitch-line-anim 0.3s steps(2, start) infinite reverse;
    bottom: 10%;
}

/* 캐릭터: RGB 흔들림 */
.cinematic-wrapper.theme-glitch.animate .cinematic-character {
    animation: glitch-char-rgb-shake var(--custom-duration) linear forwards;
}

.cinematic-wrapper.theme-glitch.animate .cinematic-text-main {
    animation: glitch-text-in 0.3s steps(4, end) forwards;
}

.cinematic-wrapper.theme-glitch.animate .cinematic-text-sub {
    animation: glitch-text-in 0.3s steps(4, end) forwards 0.2s;
}

/* --- Keyframes --- */

/*   배경이 랜덤하게 뜯겨 나가는 하드 글리치 효과 */
@keyframes glitch-bg-hard-break {
    0% {
        clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        transform: translateY(-50%) translateX(0);
        opacity: 1;
    }

    /* 1. 상단 깨짐 */
    5% {
        clip-path: polygon(0 10%, 100% 0, 100% 90%, 0 100%);
        transform: translateY(-50%) translateX(-2px);
    }

    /* 2. 중간 찢어짐 */
    10% {
        clip-path: polygon(0 0, 40% 0, 45% 20%, 0 20%, 0 80%, 55% 80%, 60% 100%, 0 100%);
        transform: translateY(-50%) translateX(2px);
        opacity: 0.9;
    }

    /* 3. 복구 */
    15% {
        clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        transform: translateY(-50%) translateX(0);
    }

    /* 4. 심한 노이즈 (가운데가 텅 빔) */
    40% {
        clip-path: polygon(0 0, 100% 0, 100% 30%, 10% 30%, 10% 70%, 100% 70%, 100% 100%, 0 100%);
        transform: translateY(-50%) translateX(-5px);
        opacity: 0.8;
    }

    /* 5. 사선 컷 */
    45% {
        clip-path: polygon(10% 0, 90% 0, 100% 100%, 0 100%);
        transform: translateY(-50%) translateX(5px);
    }

    50% {
        clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        transform: translateY(-50%) translateX(0);
        opacity: 1;
    }

    /* 6. 퇴장 직전 격렬함 */
    85% {
        clip-path: polygon(0 20%, 100% 0, 100% 80%, 0 100%);
        transform: translateY(-50%) translateX(-3px);
    }

    90% {
        clip-path: inset(40% 0 40% 0);
        /* 얇아짐 */
        transform: translateY(-50%) translateX(3px);
    }

    100% {
        opacity: 0;
        clip-path: inset(50% 0 50% 0);
    }
}

@keyframes glitch-line-anim {
    0% {
        transform: translateX(-100%);
        opacity: 1;
    }

    50% {
        transform: translateX(100%);
        opacity: 1;
    }

    100% {
        transform: translateX(-100%);
        opacity: 0;
    }
}

/* 캐릭터 RGB 분리 (형태 유지) */
@keyframes glitch-char-rgb-shake {

    /* 등장 */
    0% {
        opacity: 0;
        filter: grayscale(1) brightness(0.5);
        transform: translateX(-20px) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
    }

    5% {
        opacity: 1;
        filter: drop-shadow(5px 0 0 red) drop-shadow(-5px 0 0 blue);
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
    }

    10% {
        filter: none;
    }

    /* 중간 틱틱거림 */
    20% {
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: none;
    }

    21% {
        transform: translateX(-4px) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: drop-shadow(4px 0 0 red) drop-shadow(-4px 0 0 blue);
    }

    22% {
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: none;
    }

    45% {
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: none;
    }

    46% {
        transform: translateX(4px) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: drop-shadow(-4px 0 0 red) drop-shadow(4px 0 0 blue);
    }

    47% {
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: none;
    }

    60% {
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: none;
    }

    61% {
        transform: translateX(-2px) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: invert(1);
    }

    62% {
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: none;
    }

    /* 퇴장 */
    85% {
        opacity: 1;
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: none;
    }

    88% {
        opacity: 0.9;
        transform: translateX(-5px) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: drop-shadow(8px 0 0 red) drop-shadow(-8px 0 0 blue);
    }

    92% {
        opacity: 0.5;
        transform: translateX(5px) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: drop-shadow(-12px 0 0 red) drop-shadow(12px 0 0 blue) blur(2px);
    }

    100% {
        opacity: 0;
        transform: translateX(0) rotate(var(--char-rotate)) scaleX(var(--char-mirror-x, 1));
        filter: blur(15px);
    }
}

@keyframes glitch-text-in {
    0% {
        opacity: 0;
        transform: translateX(-50px) skewX(20deg);
    }

    100% {
        opacity: 1;
        transform: translateX(0) skewX(0);
    }
}

/* Formats */
.cinematic-wrapper.theme-glitch.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    right: calc(5% - var(--char-offset-x, 0px));
    height: calc(100% * var(--char-scale, 1));
    width: auto;
}

.cinematic-wrapper.theme-glitch.format-boxed .char-mask {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 300px;
    transform: translateY(-50%);
    clip-path: inset(0 0 0 0);
    overflow: hidden;
    z-index: 2;
}

.cinematic-wrapper.theme-glitch.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(120% * var(--char-scale, 1));
    width: auto;
    transform: translateX(50px);
}

/* ==========================================================================
   20. THEME: DASH (Running / Speed / Left-to-Right)
   ========================================================================== */

/* 1. 배경 레이어 (스피드 라인) */
.cinematic-wrapper.theme-dash .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%) skewX(-20deg);
    z-index: 1;
    /* 왼쪽에서 오른쪽으로 그라데이션 (잔상 효과) */
    background: linear-gradient(90deg,
            transparent 0%,
            rgba(255, 255, 255, 0.1) 20%,
            rgba(255, 255, 255, 0.8) 50%,
            rgba(255, 255, 255, 0.1) 80%,
            transparent 100%);
    border-top: 2px solid #fff;
    border-bottom: 2px solid #fff;
    /* 마스크로 양끝을 부드럽게 */
    mask-image: linear-gradient(90deg, transparent, #000 10%, #000 90%, transparent);
    -webkit-mask-image: linear-gradient(90deg, transparent, #000 10%, #000 90%, transparent);
}

/* 2. 내부 패턴 (흐르는 선) */
.cinematic-wrapper.theme-dash .cinematic-paint {
    position: absolute;
    inset: 0;
    /* 가로 스피드 라인 패턴 */
    background-image: repeating-linear-gradient(90deg,
            transparent,
            transparent 50px,
            var(--theme-color, #ffeb3b) 50px,
            var(--theme-color, #ffeb3b) 100px);
    opacity: 0.3;
    mix-blend-mode: overlay;
    transform-origin: left;
}

/* 3. 장식선 (바람 효과) */
.cinematic-wrapper.theme-dash .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 400px;
    transform: translateY(-50%) skewX(-20deg);
    pointer-events: none;
    z-index: 2;
}

.cinematic-wrapper.theme-dash .cinematic-deco-line::after,
.cinematic-wrapper.theme-dash .cinematic-deco-line::before {
    content: "";
    position: absolute;
    height: 4px;
    width: 200px;
    background: #fff;
    box-shadow: 0 0 10px #fff;
    border-radius: 2px;
    opacity: 0;
}

.cinematic-wrapper.theme-dash .cinematic-deco-line::after {
    top: 20%;
    left: 10%;
}

.cinematic-wrapper.theme-dash .cinematic-deco-line::before {
    bottom: 20%;
    left: 20%;
    width: 300px;
}

/* 4. 텍스트 (이탤릭체로 속도감 강조) */
.cinematic-wrapper.theme-dash .cinematic-content {
    position: absolute;
    top: 50%;
    right: 10%;
    /* 오른쪽 배치 */
    transform: translateY(-50%) skewX(-20deg);
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    z-index: 10;
}

.cinematic-wrapper.theme-dash .cinematic-text-main {
    font-family: var(--cinematic-font), sans-serif;
    font-weight: 900;
    font-style: italic;
    color: var(--main-text-color, #fff);
    text-transform: uppercase;
    text-shadow: 4px 4px 0 var(--theme-color), 8px 8px 0 rgba(0, 0, 0, 0.5);
    margin: 0;
    line-height: 0.9;
    transform: translateX(100px);
    opacity: 0;
}

.cinematic-wrapper.theme-dash .cinematic-text-sub {
    font-family: var(--cinematic-font), sans-serif;
    font-weight: bold;
    font-style: italic;
    background: #000;
    color: var(--sub-text-color, #fff);
    padding: 2px 20px;
    margin-top: 10px;
    border: 2px solid var(--theme-color);
    transform: translateX(100px);
    opacity: 0;
}

/* --- ANIMATIONS --- */

/* 배경: 왼쪽에서 오른쪽으로 쉭 지나감 */
.cinematic-wrapper.theme-dash.animate .cinematic-bg-layer {
    animation: dash-bg-swipe var(--custom-duration) cubic-bezier(0.19, 1, 0.22, 1) forwards;
}

/* 패턴: 계속 흐름 */
.cinematic-wrapper.theme-dash.animate .cinematic-paint {
    animation: dash-pattern-flow 0.5s linear infinite;
}

/* 캐릭터: 왼쪽 -> 오른쪽 진입 */
.cinematic-wrapper.theme-dash.animate .cinematic-character {
    animation: dash-char-run var(--custom-duration) cubic-bezier(0.19, 1, 0.22, 1) forwards;
}

/* 텍스트: 오른쪽 -> 왼쪽 진입 (충돌 느낌) */
.cinematic-wrapper.theme-dash.animate .cinematic-text-main {
    animation: dash-text-slide var(--custom-duration) cubic-bezier(0.19, 1, 0.22, 1) forwards 0.1s;
}

.cinematic-wrapper.theme-dash.animate .cinematic-text-sub {
    animation: dash-text-slide var(--custom-duration) cubic-bezier(0.19, 1, 0.22, 1) forwards 0.2s;
}

/* 장식선: 휙 지나가는 효과 */
.cinematic-wrapper.theme-dash.animate .cinematic-deco-line::after {
    animation: dash-wind-line 1s ease-out infinite;
}

.cinematic-wrapper.theme-dash.animate .cinematic-deco-line::before {
    animation: dash-wind-line 1.5s ease-out infinite 0.2s;
}

/* --- KEYFRAMES --- */

@keyframes dash-bg-swipe {
    0% {
        transform: translateY(-50%) skewX(-20deg) translateX(-100%);
        opacity: 0;
    }

    10% {
        transform: translateY(-50%) skewX(-20deg) translateX(0);
        opacity: 1;
    }

    90% {
        transform: translateY(-50%) skewX(-20deg) translateX(5%);
        opacity: 1;
    }

    100% {
        transform: translateY(-50%) skewX(-20deg) translateX(100%);
        opacity: 0;
    }
}

@keyframes dash-pattern-flow {
    0% {
        transform: translateX(0);
    }

    100% {
        transform: translateX(100px);
    }
}

@keyframes dash-char-run {
    0% {
        transform: translateX(-150%) skewX(30deg) rotate(var(--char-rotate)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
        filter: blur(20px);
    }

    20% {
        transform: translateX(-15%) skewX(10deg) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) blur(0);
    }

    85% {
        transform: translateX(15%) skewX(5deg) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
        filter: var(--char-shadow-filter) blur(0);
    }

    100% {
        transform: translateX(200%) skewX(-20deg) rotate(var(--char-rotate)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
        filter: blur(20px);
    }
}

@keyframes dash-text-slide {
    0% {
        transform: translateX(200px);
        opacity: 0;
    }

    15% {
        transform: translateX(0);
        opacity: 1;
    }

    90% {
        transform: translateX(0);
        opacity: 1;
    }

    100% {
        transform: translateX(200px);
        opacity: 0;
    }
}

@keyframes dash-wind-line {
    0% {
        transform: translateX(-100%);
        opacity: 0;
        width: 100px;
    }

    50% {
        opacity: 1;
        width: 400px;
    }

    100% {
        transform: translateX(200%);
        opacity: 0;
        width: 100px;
    }
}

/* --- FORMATS --- */

/* Popout: 캐릭터가 더 크게 나옴 */
.cinematic-wrapper.theme-dash.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    left: calc(10% - var(--char-offset-x, 0px));
    height: calc(110% * var(--char-scale, 1));
    width: auto;
    filter: var(--char-shadow-filter) drop-shadow(-10px 0 10px rgba(0, 0, 0, 0.5));
    transform: translateX(-100%);
    opacity: 0;
}

/* Boxed: 배경 안에 갇힘 */
.cinematic-wrapper.theme-dash.format-boxed .char-mask {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 350px;
    transform: translateY(-50%) skewX(-20deg);
    overflow: hidden;
    z-index: 2;
    border-top: 2px solid #fff;
    border-bottom: 2px solid #fff;
}

.cinematic-wrapper.theme-dash.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    left: calc(10% - var(--char-offset-x, 0px));
    height: calc(130% * var(--char-scale, 1));
    width: auto;
    /* Boxed에서는 skew를 상쇄해줘야 캐릭터가 똑바로 서있음 */
    transform: skewX(20deg) translateX(-100%);
    opacity: 0;
}

/* Boxed용 애니메이션 재정의 (Skew 상쇄) */
.cinematic-wrapper.theme-dash.format-boxed.animate .cinematic-character {
    animation: dash-char-run-boxed var(--custom-duration) cubic-bezier(0.19, 1, 0.22, 1) forwards;
}

@keyframes dash-char-run-boxed {
    0% {
        transform: skewX(20deg) translateX(-150%) rotate(var(--char-rotate, 0deg)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
        filter: blur(10px);
    }

    20% {
        transform: skewX(20deg) translateX(-10%) rotate(var(--char-rotate, 0deg)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: blur(0);
    }

    85% {
        transform: skewX(20deg) translateX(10%) rotate(var(--char-rotate, 0deg)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 1;
        filter: blur(0);
    }

    100% {
        transform: skewX(20deg) translateX(150%) rotate(var(--char-rotate, 0deg)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
        filter: blur(10px);
    }
}

/* ==========================================================================
   21. THEME: RUNES (Stone Tablet / Ancient / Heavy)
   ========================================================================== */

/* 1. 배경: 깨진 석판 느낌 */
.cinematic-wrapper.theme-runes .cinematic-bg-layer {
    /* [수정] box-sizing 추가 및 top 변수 강제 적용 */
    position: absolute;
    top: var(--screen-y, 50%) !important;
    /* 위치 고정 */
    left: 0;
    width: 100%;
    height: 380px;
    box-sizing: border-box;
    /* 테두리를 높이에 포함 */

    transform: translateY(-50%);
    z-index: 1;

    background: #1a1a1a;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.1'/%3E%3C/svg%3E");

    clip-path: polygon(0% 5%, 5% 0%, 20% 5%, 35% 0%, 50% 5%, 65% 0%, 80% 5%, 95% 0%, 100% 5%,
            100% 95%, 95% 100%, 80% 95%, 65% 100%, 50% 95%, 35% 100%, 20% 95%, 5% 100%, 0% 95%);

    filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.8));

    border-top: 3px solid var(--theme-color, #00ffff);
    border-bottom: 3px solid var(--theme-color, #00ffff);
}


/* 2. 내부 문양: 룬 문자 음각 효과 */
.cinematic-wrapper.theme-runes .cinematic-paint {
    /* [위치 고정] 부모(bg-layer) 내부에 꽉 채움 -> 이중 이동 방지 */
    position: absolute !important;
    inset: 0 !important;
    /* top:0, left:0, w:100%, h:100% 와 동일 */
    width: 100% !important;
    height: 100% !important;
    margin: 0 !important;
    transform: none !important;
    z-index: 2;

    /* [스타일] 시각적 효과 유지 */
    background-image:
        radial-gradient(circle, var(--theme-color) 2px, transparent 2.5px),
        linear-gradient(45deg, transparent 48%, var(--theme-color) 49%, var(--theme-color) 51%, transparent 52%);
    background-size: 30px 30px, 60px 60px;

    opacity: 0.4;
    /* 가시성 확보 */
    mix-blend-mode: color-dodge;

    /* 배경 모양과 동일하게 잘라냄 */
    clip-path: polygon(0% 5%, 5% 0%, 20% 5%, 35% 0%, 50% 5%, 65% 0%, 80% 5%, 95% 0%, 100% 5%,
            100% 95%, 95% 100%, 80% 95%, 65% 100%, 50% 95%, 35% 100%, 20% 95%, 5% 100%, 0% 95%);

    /* 애니메이션 유지 */
    animation: runes-glow-pulse 2s ease-in-out infinite;
}

/* 3. 장식선: 떠다니는 비석 조각들 */
.cinematic-wrapper.theme-runes .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 420px;
    transform: translateY(-50%);
    pointer-events: none;
    z-index: 2;
}

.cinematic-wrapper.theme-runes .cinematic-deco-line::after,
.cinematic-wrapper.theme-runes .cinematic-deco-line::before {
    content: "";
    position: absolute;
    width: 60px;
    height: 60px;
    background: #1a1a1a;
    border: 1px solid var(--theme-color);
    box-shadow: 0 0 10px var(--theme-color);
    opacity: 0;
}

.cinematic-wrapper.theme-runes .cinematic-deco-line::after {
    top: 0;
    left: 10%;
    transform: rotate(45deg);
}

.cinematic-wrapper.theme-runes .cinematic-deco-line::before {
    bottom: 0;
    right: 10%;
    transform: rotate(15deg);
}

/* 4. 텍스트 */
.cinematic-wrapper.theme-runes .cinematic-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    text-align: center;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.cinematic-wrapper.theme-runes .cinematic-text-main {
    font-family: serif;
    font-weight: 900;
    color: var(--main-text-color, #fff);
    text-transform: uppercase;
    letter-spacing: 5px;
    text-shadow: 0px 2px 0px #000, 0 0 15px var(--theme-color);
    transform: scale(1.5);
    opacity: 0;
}

.cinematic-wrapper.theme-runes .cinematic-text-sub {
    font-family: serif;
    font-weight: bold;
    background: rgba(0, 0, 0, 0.6);
    border: 1px solid var(--theme-color);
    color: var(--sub-text-color, #fff);
    padding: 5px 30px;
    margin-top: 15px;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.8);
    transform: translateY(20px);
    opacity: 0;
}

/* --- ANIMATIONS --- */

/* 배경과 패턴이 동일한 transform 애니메이션을 수행하도록 설정 */
.cinematic-wrapper.theme-runes.animate .cinematic-bg-layer {
    animation: runes-slam-down var(--custom-duration) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
}

.cinematic-wrapper.theme-runes.animate .cinematic-paint {
    /* 이동(slam-down)과 발광(pulse) 동시 적용 */
    animation:
        runes-slam-down var(--custom-duration) cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards,
        runes-glow-pulse 2s ease-in-out infinite;
}

.cinematic-wrapper.theme-runes.animate .cinematic-deco-line::after {
    animation: runes-float-up var(--custom-duration) ease-out forwards 0.2s;
}

.cinematic-wrapper.theme-runes.animate .cinematic-deco-line::before {
    animation: runes-float-down var(--custom-duration) ease-out forwards 0.3s;
}

.cinematic-wrapper.theme-runes.animate .cinematic-character {
    animation: runes-char-rise var(--custom-duration) ease-out forwards 0.1s;
}

.cinematic-wrapper.theme-runes.animate .cinematic-text-main {
    animation: runes-text-impact var(--custom-duration) cubic-bezier(0.5, 0, 0.75, 0) forwards 0.2s;
}

.cinematic-wrapper.theme-runes.animate .cinematic-text-sub {
    animation: runes-sub-fade var(--custom-duration) ease-out forwards 0.5s;
}

/* --- KEYFRAMES --- */

@keyframes runes-slam-down {

    /* transform-origin이 center이므로, translateY(-50%)를 기준으로 이동해야 중앙 정렬 유지 */
    0% {
        transform: translateY(-200%);
        opacity: 0;
    }

    20% {
        transform: translateY(-50%);
        opacity: 1;
    }

    /* 화면 중앙 */
    90% {
        transform: translateY(-50%);
        opacity: 1;
    }

    100% {
        transform: translateY(100%);
        opacity: 0;
    }
}

@keyframes runes-glow-pulse {
    0% {
        opacity: 0.2;
    }

    50% {
        opacity: 0.5;
    }

    100% {
        opacity: 0.2;
    }
}

@keyframes runes-char-rise {
    0% {
        transform: translateY(100px) rotate(var(--char-rotate)) scale(calc(0.9 * var(--char-mirror-x, 1)), 0.9);
        opacity: 0;
        filter: brightness(0.2) grayscale(1);
    }

    20% {
        transform: translateY(0) rotate(var(--char-rotate)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1) grayscale(0);
    }

    90% {
        transform: translateY(-10px) rotate(var(--char-rotate)) scale(calc(1.02 * var(--char-mirror-x, 1)), 1.02);
        opacity: 1;
        filter: var(--char-shadow-filter) brightness(1);
    }

    100% {
        transform: translateY(-20px) rotate(var(--char-rotate)) scale(calc(1.05 * var(--char-mirror-x, 1)), 1.05);
        opacity: 0;
        filter: var(--char-shadow-filter) brightness(1);
    }
}

@keyframes runes-text-impact {
    0% {
        transform: scale(3);
        opacity: 0;
        filter: blur(5px);
    }

    20% {
        transform: scale(1);
        opacity: 1;
        filter: blur(0);
    }

    90% {
        transform: scale(1);
        opacity: 1;
    }

    100% {
        transform: scale(0.9);
        opacity: 0;
        filter: blur(5px);
    }
}

@keyframes runes-sub-fade {
    0% {
        transform: translateY(20px);
        opacity: 0;
    }

    20% {
        transform: translateY(0);
        opacity: 1;
    }

    90% {
        transform: translateY(0);
        opacity: 1;
    }

    100% {
        transform: translateY(10px);
        opacity: 0;
    }
}

@keyframes runes-float-up {
    0% {
        transform: translateY(50px) rotate(45deg);
        opacity: 0;
    }

    20% {
        opacity: 0.8;
    }

    100% {
        transform: translateY(-50px) rotate(90deg);
        opacity: 0;
    }
}

@keyframes runes-float-down {
    0% {
        transform: translateY(-50px) rotate(15deg);
        opacity: 0;
    }

    20% {
        opacity: 0.8;
    }

    100% {
        transform: translateY(50px) rotate(-15deg);
        opacity: 0;
    }
}

/* --- FORMATS --- */
.cinematic-wrapper.theme-runes.format-popout .cinematic-character {
    bottom: calc(-10% - var(--char-offset-y, 0px));
    left: 50%;
    margin-left: calc(-20vh - var(--char-offset-x, 0px));
    height: calc(110% * var(--char-scale, 1));
    width: auto;
    filter: drop-shadow(0 0 10px var(--theme-color)) contrast(1.1);
    transform: translateY(100px);
    opacity: 0;
}

.cinematic-wrapper.theme-runes.format-boxed .char-mask {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 380px;
    transform: translateY(-50%);
    z-index: 2;
    clip-path: polygon(0% 5%, 5% 0%, 20% 5%, 35% 0%, 50% 5%, 65% 0%, 80% 5%, 95% 0%, 100% 5%,
            100% 95%, 95% 100%, 80% 95%, 65% 100%, 50% 95%, 35% 100%, 20% 95%, 5% 100%, 0% 95%);
    overflow: hidden;
}

.cinematic-wrapper.theme-runes.format-boxed .cinematic-character {
    top: calc(-10% + var(--char-offset-y, 0px));
    left: 50%;
    margin-left: calc(-25vh - var(--char-offset-x, 0px));
    height: calc(130% * var(--char-scale, 1));
    width: auto;
    filter: drop-shadow(0 0 5px #000) sepia(0.3);
    transform: translateY(50px);
    opacity: 0;
}

/* ==========================================================================
   GLOBAL POSITION OVERRIDE 
   ========================================================================== */

/* GROUP 1: Y축(높이)만 조절 가능 (X축은 테마 고유 레이아웃 유지) */
.cinematic-wrapper.theme-brush .cinematic-bg-layer,
.cinematic-wrapper.theme-brush .cinematic-deco-line,
.cinematic-wrapper.theme-brush .cinematic-content,
.cinematic-wrapper.theme-cyber .cinematic-bg-layer,
.cinematic-wrapper.theme-cyber .cinematic-deco-line,
.cinematic-wrapper.theme-cyber .cinematic-content,
.cinematic-wrapper.theme-royal .cinematic-bg-layer,
.cinematic-wrapper.theme-royal .cinematic-deco-line,
.cinematic-wrapper.theme-royal .cinematic-content,
.cinematic-wrapper.theme-royal .cinematic-border-layer,
.cinematic-wrapper.theme-saga .cinematic-bg-layer,
.cinematic-wrapper.theme-saga .cinematic-deco-line,
.cinematic-wrapper.theme-saga .cinematic-content,
.cinematic-wrapper.theme-tribal .cinematic-bg-layer,
.cinematic-wrapper.theme-tribal .cinematic-deco-line,
.cinematic-wrapper.theme-tribal .cinematic-content,
.cinematic-wrapper.theme-scope .cinematic-paint,
.cinematic-wrapper.theme-scope .cinematic-deco-line,
.cinematic-wrapper.theme-scope .cinematic-content,
.cinematic-wrapper.theme-cinematic .cinematic-bg-layer,
.cinematic-wrapper.theme-cinematic .cinematic-deco-line,
.cinematic-wrapper.theme-cinematic .cinematic-content,
.cinematic-wrapper.theme-phantom .cinematic-bg-layer,
.cinematic-wrapper.theme-phantom .cinematic-deco-line,
.cinematic-wrapper.theme-phantom .cinematic-content,
.cinematic-wrapper.theme-phantom .cinematic-border-layer,
.cinematic-wrapper.theme-arcane .cinematic-bg-layer,
.cinematic-wrapper.theme-arcane .cinematic-deco-line,
.cinematic-wrapper.theme-arcane .cinematic-content,
.cinematic-wrapper.theme-arcane .cinematic-border-layer,
.cinematic-wrapper.theme-voltage .cinematic-bg-layer,
.cinematic-wrapper.theme-voltage .cinematic-deco-line,
.cinematic-wrapper.theme-voltage .cinematic-content,
.cinematic-wrapper.theme-impact .cinematic-bg-layer,
.cinematic-wrapper.theme-impact .cinematic-paint,
.cinematic-wrapper.theme-impact .cinematic-deco-line,
.cinematic-wrapper.theme-blossom .cinematic-bg-layer,
.cinematic-wrapper.theme-blossom .cinematic-deco-line,
.cinematic-wrapper.theme-blossom .cinematic-content,
.cinematic-wrapper.theme-burst .cinematic-bg-layer,
.cinematic-wrapper.theme-burst .cinematic-deco-line,
.cinematic-wrapper.theme-burst .cinematic-content,
.cinematic-wrapper.theme-glitch .cinematic-bg-layer,
.cinematic-wrapper.theme-glitch .cinematic-deco-line,
.cinematic-wrapper.theme-glitch .cinematic-content,
.cinematic-wrapper.theme-dash .cinematic-bg-layer,
.cinematic-wrapper.theme-dash .cinematic-deco-line,
.cinematic-wrapper.theme-dash .cinematic-content,
.cinematic-wrapper.theme-runes .cinematic-bg-layer,
.cinematic-wrapper.theme-runes .cinematic-deco-line,
.cinematic-wrapper.theme-runes .cinematic-content {
    top: var(--screen-y, 50%) !important;
}

.cinematic-wrapper.format-boxed .char-mask {
    top: var(--screen-y, 50%) !important;
}

.cinematic-wrapper.theme-slash.format-boxed .char-mask {
    top: 0 !important;
}

.cinematic-wrapper.theme-impact .cinematic-content {
    top: calc(var(--screen-y, 50%) - 20%) !important;
}

/* GROUP 2: X, Y축 모두 조절 가능 */
.cinematic-wrapper.theme-blitz .cinematic-bg-layer,
.cinematic-wrapper.theme-blitz .cinematic-deco-line,
.cinematic-wrapper.theme-blitz .char-mask,
.cinematic-wrapper.theme-blitz .cinematic-content,
.cinematic-wrapper.theme-blitz_left .cinematic-bg-layer,
.cinematic-wrapper.theme-blitz_left .cinematic-deco-line,
.cinematic-wrapper.theme-blitz_left .char-mask,
.cinematic-wrapper.theme-blitz_left .cinematic-content {
    top: var(--screen-y, 50%) !important;
    left: var(--screen-x, 50%) !important;
}


/* ==========================================================================
   GLOBAL Z-INDEX MANAGEMENT & LAYERING FIXES
   ========================================================================== */

/* 1. 통합 레이어 컨테이너 */
.cinematic-custom-layers {
    display: contents;
}

/* 
   2. 기본 시스템 요소 Z-Index (Standard Stack)
   - Popout 모드 기준
   - 배경(10) < 장식선(20) < 테두리(25) < 캐릭터(50) < 텍스트(100)
*/
.cinematic-bg-layer {
    z-index: 10 !important;
}

.cinematic-paint {
    z-index: 11 !important;
}

/* [장식선] 마법진, 로얄 내부선 등 - 항상 캐릭터 뒤 */
.cinematic-deco-line {
    z-index: 25 !important;
}

/* [테두리] 기본은 캐릭터 뒤 (Popout일 때 캐릭터가 덮음) */
.cinematic-border-layer {
    z-index: 20 !important;
}

.char-mask,
.cinematic-character {
    z-index: 50 !important;
}

.cinematic-content {
    z-index: 100 !important;
}

.cinematic-text-main {
    z-index: 101 !important;
}

.cinematic-text-sub {
    z-index: 101 !important;
}


/* 
   3. Boxed Mode 강제 오버라이드
*/
.cinematic-wrapper.format-boxed .cinematic-border-layer {
    z-index: 60 !important;
}

/* 
   4. 특정 테마 예외 처리 (원래 선이 앞에 있어야 하는 테마들)
   - 이 테마들은 deco-line 자체가 앞을 가로지르는 연출임
*/
.cinematic-wrapper.theme-slash .cinematic-deco-line,
.cinematic-wrapper.theme-blitz .cinematic-deco-line,
.cinematic-wrapper.theme-blitz_left .cinematic-deco-line,
.cinematic-wrapper.theme-voltage .cinematic-deco-line,
.cinematic-wrapper.theme-cinematic.format-boxed .cinematic-deco-line,
.cinematic-wrapper.theme-tribal.format-boxed .cinematic-deco-line,
.cinematic-wrapper.theme-blossom.format-boxed .cinematic-deco-line,
.cinematic-wrapper.theme-saga.format-boxed .cinematic-deco-line,
.cinematic-wrapper.theme-scope.format-boxed .cinematic-deco-line {
    z-index: 60 !important;
}

/* Wanted (Mugshot) - 배경 자체가 창살 역할 */
.cinematic-group-container.theme-wanted .slice-bg {
    z-index: 60 !important;
}

/* 개별 미디어 요소 스타일 */
.custom-layer-media {
    pointer-events: none;
    will-change: transform, opacity;
}

.cinematic-border-layer {
    position: absolute;
    inset: 0;
    pointer-events: none;
}


/* ==========================================================================
   22. THEME: TYPEWRITER (Typing Text Effect)
   ========================================================================== */

.cinematic-wrapper.theme-typewriter .cinematic-bg-layer,
.cinematic-wrapper.theme-typewriter .cinematic-paint,
.cinematic-wrapper.theme-typewriter .cinematic-deco-line,
.cinematic-wrapper.theme-typewriter .cinematic-border-layer {
    display: none !important;
}

.cinematic-wrapper.theme-typewriter .cinematic-content {
    position: absolute;
    top: var(--screen-y, 50%);
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.cinematic-wrapper.theme-typewriter .cinematic-text-main {
    font-family: var(--cinematic-font, "Courier New", monospace);
    color: var(--main-text-color, #00ff00);
    text-shadow: 0 0 8px currentColor;
    opacity: 0;
    transform: none !important;
    white-space: pre-wrap;
    line-height: 1.2;
}

.cinematic-wrapper.theme-typewriter .cinematic-text-sub {
    font-family: var(--cinematic-font, "Courier New", monospace);
    color: var(--sub-text-color, #00cc00);
    text-shadow: 0 0 5px currentColor;
    opacity: 0;
    transform: none !important;
    white-space: pre-wrap;
    line-height: 1.2;
    margin-top: 0.5rem;
}

.cinematic-wrapper.theme-typewriter .typewriter-cursor {
    animation: typewriter-blink 0.5s step-end infinite;
    font-weight: bold;
    margin-left: 2px;
}

.cinematic-wrapper.theme-typewriter .cinematic-character,
.cinematic-wrapper.theme-typewriter .char-mask {
    display: none !important;
}

@keyframes typewriter-blink {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0;
    }
}

#preview-stage.theme-typewriter .cinematic-text-main,
#preview-stage.theme-typewriter .cinematic-text-sub {
    opacity: 1 !important;
    transform: none !important;
}

#preview-stage.theme-typewriter.animate .cinematic-text-main,
#preview-stage.theme-typewriter.animate .cinematic-text-sub {
    animation: none !important;
}


/* ==========================================================================
   23. THEME: YAKUZA (Like a Dragon / Ryuu ga Gotoku Name Introduction)
   ========================================================================== */

/* Background - Dark dramatic vignette */
.cinematic-wrapper.theme-yakuza .cinematic-bg-layer {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 400px;
    transform: translateY(-50%);
    z-index: 1;
}

.cinematic-wrapper.theme-yakuza .cinematic-paint {
    display: none;
}

/* Accent line - dramatic red/gold streak */
.cinematic-wrapper.theme-yakuza .cinematic-deco-line {
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 400px;
    transform: translateY(-50%);
    pointer-events: none;
    z-index: 15;
}

.cinematic-wrapper.theme-yakuza .cinematic-deco-line::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, transparent, var(--theme-color, #c41e3a), var(--theme-color, #c41e3a), transparent);
    transform: translateY(-50%) scaleX(0);
    box-shadow: 0 0 20px var(--theme-color, #c41e3a);
}

.cinematic-wrapper.theme-yakuza .cinematic-deco-line::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(90deg, transparent 10%, rgba(255, 255, 255, 0.3) 50%, transparent 90%);
    transform: translateY(30px) scaleX(0);
}

/* Text Layout - Centered dramatic */
.cinematic-wrapper.theme-yakuza .cinematic-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    z-index: 100;
}

.cinematic-wrapper.theme-yakuza .cinematic-text-main {
    font-weight: 900;
    font-style: normal;
    letter-spacing: 10px;
    color: var(--main-text-color, #ffffff);
    text-shadow:
        0 0 30px rgba(255, 255, 255, 0.5),
        0 5px 15px rgba(0, 0, 0, 0.8),
        3px 3px 0 rgba(0, 0, 0, 0.5);
    transform: scale(3) translateY(-20px);
    opacity: 0;
    margin-left: var(--main-offset-x, 0px);
    margin-top: var(--main-offset-y, 0px);
}

.cinematic-wrapper.theme-yakuza .cinematic-text-sub {
    font-weight: 400;
    letter-spacing: 5px;
    color: var(--sub-text-color, #888888);
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
    background: transparent;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    padding: 10px 40px 5px 40px;
    margin-top: calc(15px + var(--sub-offset-y, 0px));
    margin-left: var(--sub-offset-x, 0px);
    transform: translateY(20px);
    opacity: 0;
}

/* Character - Dramatic reveal from darkness */
.cinematic-wrapper.theme-yakuza.format-popout .char-mask {
    position: absolute;
    inset: 0;
    z-index: 50;
    overflow: visible;
}

.cinematic-wrapper.theme-yakuza.format-popout .cinematic-character {
    bottom: calc(-15% - var(--char-offset-y, 0px));
    right: calc(10% - var(--char-offset-x, 0px));
    height: calc(110% * var(--char-scale, 1));
    width: auto;
    filter: brightness(0) blur(10px);
}

.cinematic-wrapper.theme-yakuza.format-boxed .char-mask {
    top: 50%;
    left: 0;
    width: 100%;
    height: 400px;
    transform: translateY(-50%);
    clip-path: polygon(0 15%, 100% 0%, 100% 85%, 0% 100%);
    overflow: hidden;
}

.cinematic-wrapper.theme-yakuza.format-boxed .cinematic-character {
    top: calc(-15% + var(--char-offset-y, 0px));
    right: calc(15% - var(--char-offset-x, 0px));
    height: calc(130% * var(--char-scale, 1));
    width: auto;
    filter: brightness(0) blur(10px);
}

/* Animations */
.cinematic-wrapper.theme-yakuza.animate .cinematic-paint {
    animation: yakuza-bg-open var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.cinematic-wrapper.theme-yakuza.animate .cinematic-deco-line::after {
    animation: yakuza-line-sweep var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.2s;
}

.cinematic-wrapper.theme-yakuza.animate .cinematic-deco-line::before {
    animation: yakuza-line-sweep var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.4s;
}

.cinematic-wrapper.theme-yakuza.animate .cinematic-character {
    animation: yakuza-char-reveal var(--custom-duration, 3.5s) cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: 0.1s;
}

.cinematic-wrapper.theme-yakuza.animate .cinematic-text-main {
    animation: yakuza-name-slam var(--custom-duration, 3.5s) cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    animation-delay: 0.3s;
}

.cinematic-wrapper.theme-yakuza.animate .cinematic-text-sub {
    animation: yakuza-title-fade var(--custom-duration, 3.5s) ease-out forwards;
    animation-delay: 0.6s;
}

.cinematic-wrapper.theme-yakuza.animate,
.cinematic-aspect-stage.theme-yakuza.animate {
    animation: yakuza-fade-out var(--custom-duration, 3.5s) ease-out forwards;
}

@keyframes yakuza-fade-out {

    0%,
    85% {
        opacity: 1;
    }

    100% {
        opacity: 0;
    }
}

/* Keyframes */
@keyframes yakuza-bg-open {
    0% {
        transform: scaleY(0);
        opacity: 0;
    }

    15% {
        transform: scaleY(1);
        opacity: 1;
    }

    85% {
        transform: scaleY(1);
        opacity: 1;
    }

    100% {
        transform: scaleY(0);
        opacity: 0;
    }
}

@keyframes yakuza-line-sweep {
    0% {
        transform: translateY(-50%) scaleX(0);
        opacity: 0;
    }

    20% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }

    100% {
        transform: translateY(-50%) scaleX(1);
        opacity: 1;
    }
}

@keyframes yakuza-char-reveal {
    0% {
        filter: brightness(0) blur(10px);
        transform: rotate(var(--char-rotate, 0deg)) scale(calc(1.1 * var(--char-mirror-x, 1)), 1.1);
        opacity: 0;
    }

    20% {
        filter: var(--char-shadow-filter) brightness(1.2) blur(0);
        transform: rotate(var(--char-rotate, 0deg)) scale(calc(1 * var(--char-mirror-x, 1)), 1);
        opacity: 1;
    }

    25% {
        filter: var(--char-shadow-filter) brightness(1) blur(0);
    }

    35% {
        filter: grayscale(0) brightness(1);
        transform: rotate(var(--char-rotate, 0deg)) scale(calc(1.02 * var(--char-mirror-x, 1)), 1.02);
        opacity: 1;
    }

    75% {
        filter: grayscale(1) brightness(0.7);
        opacity: 1;
    }

    100% {
        filter: grayscale(1) brightness(0.7);
        transform: rotate(var(--char-rotate, 0deg)) scale(calc(1.02 * var(--char-mirror-x, 1)), 1.02);
        opacity: 1;
    }
}

@keyframes yakuza-name-slam {
    0% {
        transform: scale(3) translateY(-20px);
        opacity: 0;
        letter-spacing: 30px;
        filter: blur(10px);
    }

    15% {
        transform: scale(0.95) translateY(5px);
        opacity: 1;
        letter-spacing: 8px;
        filter: blur(0);
    }

    20% {
        transform: scale(1) translateY(0);
        letter-spacing: 10px;
    }

    100% {
        transform: scale(1) translateY(0);
        opacity: 1;
        letter-spacing: 10px;
        filter: blur(0);
    }
}

@keyframes yakuza-title-fade {
    0% {
        transform: translateY(20px);
        opacity: 0;
    }

    15% {
        transform: translateY(0);
        opacity: 1;
    }

    100% {
        transform: translateY(0);
        opacity: 1;
    }
}

/* Position Override for Yakuza */
.cinematic-wrapper.theme-yakuza .cinematic-bg-layer,
.cinematic-wrapper.theme-yakuza .cinematic-deco-line,
.cinematic-wrapper.theme-yakuza .cinematic-content {
    top: var(--screen-y, 50%) !important;
}

/* Yakuza Full Screen Grayscale Effect */
body.cinematic-yakuza-active #board {
    animation: yakuza-canvas-grayscale var(--custom-duration, 3.5s) ease-out forwards;
}

@keyframes yakuza-canvas-grayscale {

    0%,
    35% {
        filter: none;
    }

    75%,
    100% {
        filter: grayscale(1) brightness(0.8);
    }
}